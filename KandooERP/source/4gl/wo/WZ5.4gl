
# module generated by Querix Ffg(c) 		                                                                                     	#@G00002
# Generated on 2019-07-16 18:20:57		                                                                                       	#@G00003
# Main template I:\Users\BeGooden-IT\git\KandooERP\KandooERP\Resources\Utilities\Perl\Ffg/templates/module/standalone-form-kandoo.mtplt 			#@G00004

############################################################
# GLOBAL Scope Variables
############################################################
GLOBALS "../common/glob_GLOBALS.4gl"
GLOBALS "W_WO_GLOBALS.4gl"

GLOBALS		                                                                                                                  	#@G00005
	DEFINE cmpy LIKE company.cmpy_code --CHAR(2)		                                                                                                     	#@G00006
	DEFINE whom CHAR(32)		                                                                                                    	#@G00007
END GLOBALS		                                                                                                              	#@G00008
############################################################
# MODULE Scope Variables
############################################################
DEFINE m_program CHAR(30)		                                                                                                	#@G00012
DEFINE modu_cmpy_code LIKE company.cmpy_code #huho
DEFINE lku_bank 
	RECORD		                                                                                                   	#@G00013
		name_acct_text LIKE bank.name_acct_text #  nvarchar(40)		                                                                  	#@G00013
	END RECORD		                                                                                                             	#@G00014
DEFINE lku_warehouse 
	RECORD		                                                                                              	#@G00014
		desc_text LIKE warehouse.desc_text #  nvarchar(30)		                                                                       	#@G00014
	END RECORD		                                                                                                             	#@G00015
DEFINE g_location RECORD LIKE location.*													 		                                                                  	#@G00017


############################################################
# MAIN
#
#
############################################################
MAIN		                                                                                                                     	#@G00019

	DEFER INTERRUPT		                                                                                                         	#@G00020
	#OPTIONS		                                                                                                                 	#@G00021
			                                                                                                                         	#@G00021
	# WHENEVER ERROR CALL error_mngmt		                                                                                       	#@G00022
	# CALL ui_init(0) 		                                                                                                      	#@G00023
	LET m_program="p_WZ5_location"		                                                                                         	#@G00024

	CALL main_WZ5_location()		                                                                                               	#@G00026

END MAIN		                                                                                                                 	#@G00028

##########################################################################		                                               	#@G00030
FUNCTION mc_WZ5_sccs()		                                                                                                  	#@G00031
	## definition variable sccs		                                                                                              	#@G00032
	DEFINE l_sccs_var CHAR(70)		                                                                                                	#@G00033
	LET l_sccs_var="%W% %D%"		                                                                                                   	#@G00034
END FUNCTION		                                                                                                             	#@G00035

##########################################################################		                                               	#@G00036
FUNCTION main_WZ5_location ()		                                                                                           	#@G00037
## this module's main function called by MAIN		                                                                            	#@G00038

	DEFINE l_tmp_msg STRING #huho

	DEFER QUIT		                                                                                                              	#@G00039
	DEFER INTERRUPT		                                                                                                         	#@G00040

	CALL setModuleId("W120")		                                                                                                	#@G00042
	CALL ui_init(0)			                                                                                                        	#@G00043
	CALL authenticate(getModuleId()) RETURNING cmpy, whom		                                                                       	#@G00044
	
	OPEN WINDOW W120 WITH FORM "W120"		                                                                                       	#@G00046
	CALL winDecoration_w("W120")		                                                                                              	#@G00047
	CALL displaymoduletitle(NULL)  --first form of the module get's the title		                                                   	#@G00048

#------------------------------			HuHO	                                                                                                                         	#@G00219
#		MESSAGE ""		                                                                                                             	#@G00220
	IF modu_cmpy_code IS NULL THEN
		LET modu_cmpy_code = glob_rec_kandoouser.cmpy_code
		ERROR "Please select the company you want to work with"
		INPUT modu_cmpy_code WITHOUT DEFAULTS FROM cmpy_code 
			AFTER FIELD cmpy_code
				IF db_company_pk_exists(UI_OFF,modu_cmpy_code) = FALSE THEN
					LET l_tmp_msg = "Your assigned company_code ", trim(modu_cmpy_code), " is not valid!\nEnter a different/valid company code to proceed!"
					MESSAGE "Enter valid company code"
					NEXT FIELD cmpy_code
				END IF
		END INPUT
	END IF

	IF db_company_pk_exists(UI_OFF,modu_cmpy_code) = FALSE THEN
		LET l_tmp_msg = "Your assigned company_code ", trim(modu_cmpy_code), " is not valid!\nEnter a different/valid company code to proceed!"
		MESSAGE "Enter valid company code"
	END IF

	DISPLAY modu_cmpy_code TO location.cmpy_code
	DISPLAY modu_cmpy_code TO hdr_cmpy_code
	DISPLAY db_company_get_name_text(UI_OFF,modu_cmpy_code) TO company.name_text 
	DISPLAY db_company_get_name_text(UI_OFF,modu_cmpy_code) TO hdr_cmpy_name
		
#-------------------------------	
	CALL sql_prepare_queries_WZ5_location () # initialize all cursors on master table		                                      	#@G00050

	CALL menu_WZ5_location()      		                                                                                         	#@G00052

	CLOSE WINDOW W120		                                                                                                       	#@G00054

END FUNCTION		                                                                                                             	#@G00056

######################################################################		                                                   	#@G00058
FUNCTION menu_WZ5_location ()		                                                                                           	#@G00059
## menu_WZ5_location		                                                                                                    	#@G00060
## the top level menu 		                                                                                                   	#@G00061
## input arguments: none		                                                                                                 	#@G00062
## output arguments: none		                                                                                                	#@G00063
	DEFINE nbsel_location INTEGER		                                                                                           	#@G00064
	DEFINE sql_stmt_status INTEGER		                                                                                          	#@G00065
	DEFINE record_num INTEGER		                                                                                               	#@G00066
	DEFINE action smallint		                                                                                                  	#@G00067
	DEFINE xnumber smallint		                                                                                                 	#@G00068
	DEFINE arr_elem_num smallint		                                                                                            	#@G00069
	DEFINE pky_location RECORD 		                                                                                             	#@G00070
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00070
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00071
	END RECORD		                                                                                                              	#@G00072
	DEFINE l_rec_frm_WZ5 RECORD 		                                                                                                 	#@G00073
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G00073
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G00073
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G00073
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G00073
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G00073
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G00073
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G00073
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G00073
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G00073
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G00073
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G00073
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G00073
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G00073
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G00073
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G00073
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G00073
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G00073
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G00073
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G00073
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G00073
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G00073
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G00073
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G00073
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G00073
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G00073
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G00073
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G00073
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G00073
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G00073
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G00073
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G00073
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G00073
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G00073
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G00073
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G00073
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G00073
		comp_date LIKE location.comp_date #  date		                                                                                	#@G00073
				                                                                                                                         	#@G00074
	END RECORD		                                                                                                              	#@G00075
	
	DEFINE l_rec_tbl_WZ5 RECORD 		                                                                                                 	#@G00077
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00077
		locn_code LIKE location.locn_code, # nchar(3)		                                                                            	#@G00077
		desc_text LIKE location.desc_text, # nvarchar(40)		                                                                        	#@G00077
		addr1_text LIKE location.addr1_text, # nvarchar(40)		                                                                      	#@G00077
		addr2_text LIKE location.addr2_text, # nvarchar(40)		                                                                      	#@G00077
		city_text LIKE location.city_text, # nvarchar(40)		                                                                        	#@G00077
		state_code LIKE location.state_code, # nvarchar(6)		                                                                       	#@G00077
		post_code LIKE location.post_code, # nvarchar(10)		                                                                        	#@G00077
		country_code LIKE location.country_code, # nchar(3)		                                                                      	#@G00077
		contact_text LIKE location.contact_text, # nvarchar(40)		                                                                  	#@G00077
		tele_text LIKE location.tele_text, # nvarchar(20)		                                                                        	#@G00077
		fax_text LIKE location.fax_text, # nvarchar(20)		                                                                          	#@G00077
		ware_code LIKE location.ware_code, # nchar(3)		                                                                            	#@G00077
		price_high_per LIKE location.price_high_per, # DECIMAL		                                                                   	#@G00077
		price_low_per LIKE location.price_low_per, # DECIMAL		                                                                     	#@G00077
		cart_high_per LIKE location.cart_high_per, # DECIMAL		                                                                     	#@G00077
		cart_low_per LIKE location.cart_low_per, # DECIMAL		                                                                       	#@G00077
		other_high_per LIKE location.other_high_per, # DECIMAL		                                                                   	#@G00077
		other_low_per LIKE location.other_low_per, # DECIMAL		                                                                     	#@G00077
		price_auth_ind LIKE location.price_auth_ind, # nchar(1)		                                                                  	#@G00077
		pallet_charge_ind LIKE location.pallet_charge_ind, # nchar(1)		                                                            	#@G00077
		bank_code LIKE location.bank_code, # nvarchar(9)		                                                                         	#@G00077
		days_to_del LIKE location.days_to_del, # smallint		                                                                        	#@G00077
		ol_hold_code LIKE location.ol_hold_code, # nchar(3)		                                                                      	#@G00077
		tt_hold_code LIKE location.tt_hold_code, # nchar(3)		                                                                      	#@G00077
		oltt_hold_code LIKE location.oltt_hold_code, # nchar(3)		                                                                  	#@G00077
		excess_day_num LIKE location.excess_day_num, # smallint		                                                                  	#@G00077
		excess_limit_per LIKE location.excess_limit_per, # smallint		                                                              	#@G00077
		price_round_ind LIKE location.price_round_ind, # nchar(1)		                                                                	#@G00077
		disp_locn_ind LIKE location.disp_locn_ind, # nchar(1)		                                                                    	#@G00077
		stocktake_ind LIKE location.stocktake_ind, # nchar(1)		                                                                    	#@G00077
		def_labour_class LIKE location.def_labour_class, # nvarchar(8)		                                                           	#@G00077
		desc2_text LIKE location.desc2_text, # nvarchar(60)		                                                                      	#@G00077
		comp_date LIKE location.comp_date, # date		                                                                                	#@G00077
		approval_flag LIKE location.approval_flag, # nchar(1)		                                                                    	#@G00077
		summ_cfwd_flag LIKE location.summ_cfwd_flag, # nchar(1)		                                                                  	#@G00077
		edit_km_flag LIKE location.edit_km_flag, # nchar(1)		                                                                      	#@G00077
		min_cartage_ind LIKE location.min_cartage_ind, # nchar(1)		                                                                	#@G00077
		head_info_flag LIKE location.head_info_flag, # nchar(1)		                                                                  	#@G00077
		def_int_cust LIKE location.def_int_cust # nvarchar(8)				                                                                                                                         	#@G00078
	END RECORD		                                                                                                              	#@G00079
	
	DEFINE record_found INTEGER		                                                                                             	#@G00081
	DEFINE lookup_status INTEGER		                                                                                            	#@G00082



	
	
	
##############

	LET nbsel_location = 0		                                                                                                  	#@G00084
	MENU "location"		                                                                                                         	#@G00085
	BEFORE MENU		           
		CALL publish_toolbar("kandoo","WZ5","menu-location-1") 	                                                                                                  	#@G00086
		#HIDE OPTION "Next","Previous","EDIT","DELETE"		                                                                          	#@G00087

	ON ACTION "WEB-HELP" 
		CALL onlinehelp(getmoduleid(),null) 

	ON ACTION "actToolbarManager" 
		CALL setuptoolbar() 
			
	COMMAND "Query" "Query data with multiple criteria location"		                                                            	#@G00088
				                                                                                                                         	#@G00088
#		MESSAGE ""		                                                                                                             	#@G00089
		INITIALIZE l_rec_frm_WZ5.* TO NULL		                                                                                          	#@G00090
		CLEAR FORM		                                                                                                             	#@G00091
# Why is this done ?
#		DISPLAY BY NAME l_rec_frm_WZ5.*		                                                                                             	#@G00092
		HIDE OPTION "Next","Previous"		                                                                                          	#@G00093

		CALL frm_Query_WZ5() RETURNING nbsel_location		                                                                         	#@G00095
		IF nbsel_location > 0 THEN 		                                                                                            	#@G00096
			CALL sql_nxtprev_location(1) 
			RETURNING 
				record_found,		                                                                  	#@G00097
				pky_location.*		                                                                                                        	#@G00098
																											 
			

			CASE		                                                                                                                  	#@G00102
			WHEN record_found = 1		                                                                                                 	#@G00103
				LET record_num = 1		                                                                                                   	#@G00104
				CALL sql_FETCH_full_row_location (pky_location.*)		                                                                    	#@G00105
				RETURNING record_found,l_rec_frm_WZ5.*		                                                                                    	#@G00106
				CALL frm_Display_WZ5(l_rec_frm_WZ5.*)		                                                                                    	#@G00107
			WHEN record_found = -1 		                                                                                               	#@G00108
				ERROR "This row is unreachable ",sqlca.sqlcode		                                                                       	#@G00109
			END CASE		                                                                                                              	#@G00110
			IF nbsel_location > 1 THEN		                                                                                            	#@G00111
			   SHOW OPTION "Next"		                                                                                                 	#@G00112
			   NEXT OPTION "Next"		                                                                                                 	#@G00113
			END IF		                                                                                                                	#@G00114
			SHOW OPTION "EDIT","DELETE"		                                                                                           	#@G00115
														 
																											   
			 
		ELSE 		                                                                                                                  	#@G00119
			ERROR "No row matches the criteria"		                                                                                   	#@G00120
			NEXT OPTION "Query"		                                                                                                   	#@G00121
		END IF		                                                                                                                 	#@G00122

	COMMAND "Next" "Display Next record location"		                                                                           	#@G00124
				                                                                                                                         	#@G00124
		MESSAGE ""		                                                                                                             	#@G00125
		CLEAR FORM		                                                                                                             	#@G00126
		INITIALIZE l_rec_frm_WZ5.* TO NULL		                                                                                          	#@G00127
									
											
														  
																											 
													   
																											 
			

		IF record_num <= nbsel_location THEN		                                                                                   	#@G00136
			CALL sql_nxtprev_location(1) RETURNING record_found,		                                                                  	#@G00137
			pky_location.*		                                                                                                        	#@G00138

   
			CASE 		                                                                                                                 	#@G00141
			WHEN record_found = 0 		                                                                                                	#@G00142
				ERROR "FETCH Last record of this selection location"		                                                                 	#@G00143
			WHEN record_found = -1 		                                                                                               	#@G00144
				ERROR "This row is unreachable ",sqlca.sqlcode		                                                                       	#@G00145
			WHEN record_found = 1		                                                                                                 	#@G00146
				LET record_num = record_num + 1		                                                                                      	#@G00147
				CALL sql_FETCH_full_row_location (pky_location.*)		                                                                    	#@G00148
				RETURNING record_found,l_rec_frm_WZ5.*		                                                                                    	#@G00149

				CALL frm_Display_WZ5(l_rec_frm_WZ5.*)		                                                                                    	#@G00151

				IF record_num >= nbsel_location THEN		                                                                                 	#@G00153
				   HIDE OPTION "Next"		                                                                                                	#@G00154
				END IF		                                                                                                               	#@G00155
                IF record_num > 1 THEN		                                                                                   	#@G00156
                	SHOW OPTION "Previous"		                                                                                  	#@G00157
                ELSE		                                                                                                     	#@G00158
                	HIDE OPTION "Previous"		                                                                                  	#@G00159
				END IF		                                                                                                               	#@G00160
											  
														
																												
			  
			END CASE		                                                                                                              	#@G00165
		ELSE		                                                                                                                   	#@G00166
			ERROR " Please set query criteria previously location "		                                                               	#@G00167
			NEXT OPTION "Query" 		                                                                                                  	#@G00168
		END IF		                                                                                                                 	#@G00169

	COMMAND "Previous" "Display Previous Record location"		                                                                   	#@G00171
				                                                                                                                         	#@G00171
		
		MESSAGE ""		                                                                                                             	#@G00173
		CLEAR FORM		                                                                                                             	#@G00174
		INITIALIZE l_rec_frm_WZ5.* TO NULL		                                                                                          	#@G00175
									
											
														  
																											 
													   
																											 
		   

		IF record_num >= 1 THEN		                                                                                                	#@G00184
			CALL sql_nxtprev_location(-1) RETURNING record_found,		                                                                 	#@G00185
			pky_location.*		                                                                                                        	#@G00186
				   
   
			CASE 		                                                                                                                 	#@G00189
			WHEN record_found = 0		                                                                                                 	#@G00190
				ERROR "FETCH First record of this selection location"		                                                                	#@G00191
			WHEN record_found < -1		                                                                                                	#@G00192
				ERROR "This row is unreachable ",sqlca.sqlcode		                                                                       	#@G00193
			WHEN record_found = 1		                                                                                                 	#@G00194
				LET record_num = record_num - 1		                                                                                      	#@G00195
				CALL sql_FETCH_full_row_location (pky_location.*)		                                                                    	#@G00196
				RETURNING record_found,l_rec_frm_WZ5.*		                                                                                    	#@G00197
				
				CALL frm_Display_WZ5(l_rec_frm_WZ5.*)		                                                                                    	#@G00199

				IF record_num = 1 THEN		                                                                                               	#@G00201
				   HIDE OPTION "Previous"		                                                                                            	#@G00202
				END IF		                                                                                                               	#@G00203
                IF record_num < nbsel_location THEN		                                                                      	#@G00204
                	SHOW OPTION "Next"		                                                                                      	#@G00205
                ELSE		                                                                                                     	#@G00206
                	HIDE OPTION "Next"		                                                                                      	#@G00207
				END IF		                                                                                                               	#@G00208
											  
														
																											   
			 
			END CASE		                                                                                                              	#@G00213
		ELSE		                                                                                                                   	#@G00214
			ERROR " Please set query criteria previously location "		                                                               	#@G00215
			NEXT OPTION "Query"		                                                                                                   	#@G00216
		END IF		                                                                                                                 	#@G00217

	COMMAND "Insert" "Add a new record location"		                                                                            	#@G00219

	
		CALL frm_Insert_WZ5(modu_cmpy_code) RETURNING sql_stmt_status,pky_location.*		                                                        	#@G00221
		MESSAGE ""		                                                                                                             	#@G00222

	COMMAND "EDIT" "Modify current record location"		                                                                         	#@G00224
				                                                                                                                         	#@G00224
		MESSAGE ""		                                                                                                             	#@G00225
		IF nbsel_location THEN		                                                                                                 	#@G00226
			IF sql_status_pk_location(pky_location.*) < 0 THEN		                                                                    	#@G00227
				ERROR "is locked "		                                                                                                   	#@G00228
				NEXT OPTION "Next"		                                                                                                   	#@G00229
			ELSE		                                                                                                                  	#@G00230
				CALL frm_Edit_WZ5(pky_location.*,l_rec_frm_WZ5.*)		                                                                        	#@G00231
				RETURNING sql_stmt_status		                                                                                            	#@G00232
			END IF		                                                                                                                	#@G00233
		ELSE		                                                                                                                   	#@G00234
			ERROR " Please set query criteria previously location "		                                                               	#@G00235
			NEXT OPTION "Query"		                                                                                                   	#@G00236
		END IF		                                                                                                                 	#@G00237

   COMMAND "DELETE" "Suppress current record location"		                                                                   	#@G00239
				                                                                                                                         	#@G00239
		MESSAGE ""		                                                                                                             	#@G00240
		IF nbsel_location THEN		                                                                                                 	#@G00241
			IF sql_status_pk_location(pky_location.*) < 0 THEN		                                                                    	#@G00242
				ERROR "is locked "		                                                                                                   	#@G00243
				NEXT OPTION "Next"		                                                                                                   	#@G00244
			END IF		                                                                                                                	#@G00245
			WHILE TRUE		                                                                                                            	#@G00246
				CALL confirm_operation(5,10,"Delete") RETURNING action		                                                               	#@G00247
				CASE 		                                                                                                                	#@G00248
				WHEN action = 0 OR action = 1 		                                                                                       	#@G00249
					EXIT WHILE # degage abandon		                                                                                         	#@G00250
				WHEN action = 2 		                                                                                                     	#@G00251
					CALL frm_Delete_WZ5(pky_location.*)		                                                                                	#@G00252
					RETURNING sql_stmt_status		                                                                                           	#@G00253
					EXIT WHILE		                                                                                                          	#@G00254
				END CASE		                                                                                                             	#@G00255
			END WHILE		                                                                                                             	#@G00256
		ELSE		                                                                                                                   	#@G00257
			ERROR "Please set query criteria previously location "		                                                                	#@G00258
			NEXT OPTION "Query"		                                                                                                   	#@G00259
		END IF		                                                                                                                 	#@G00260

	COMMAND "Exit" "Exit program"		                                                                                           	#@G00262
				                                                                                                                         	#@G00262
		MESSAGE ""		                                                                                                             	#@G00263
		EXIT MENU		                                                                                                              	#@G00264
	END MENU		                                                                                                                	#@G00265
END FUNCTION		                                                                                                             	#@G00266

#######################################################################		                                                  	#@G00268
FUNCTION frm_Query_WZ5()		                                                                                                	#@G00269
## frm_Query_WZ5_W120 : Query By Example on table location		                                                              	#@G00270
## Input selection criteria,		                                                                                             	#@G00271
## prepare the query,		                                                                                                    	#@G00272
## OPEN the data set		                                                                                                     	#@G00273
	DEFINE rec_location,where_clause STRING		                                                                                 	#@G00274
	DEFINE xnumber,sql_stmt_status INTEGER		                                                                                  	#@G00275
	DEFINE l_pky RECORD 		                                                                                                    	#@G00276
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00276
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00277
	END RECORD		                                                                                                              	#@G00278
	DEFINE l_rec_frm_WZ5 RECORD 		                                                                                                 	#@G00279
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G00279
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G00279
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G00279
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G00279
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G00279
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G00279
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G00279
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G00279
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G00279
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G00279
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G00279
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G00279
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G00279
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G00279
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G00279
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G00279
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G00279
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G00279
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G00279
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G00279
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G00279
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G00279
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G00279
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G00279
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G00279
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G00279
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G00279
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G00279
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G00279
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G00279
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G00279
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G00279
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G00279
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G00279
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G00279
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G00279
		comp_date LIKE location.comp_date #  date		                                                                                	#@G00279
				                                                                                                                         	#@G00280
	END RECORD		                                                                                                              	#@G00281
	
	DEFINE reply CHAR(5)		                                                                                                    	#@G00283
	LET xnumber = 0		                                                                                                         	#@G00284
	MESSAGE "Please input query criteria"		                                                                                   	#@G00285
	# initialize record and display blank		                                                                                   	#@G00286
	CLEAR FORM		                                                                                                              	#@G00287
	INITIALIZE l_rec_frm_WZ5.* TO NULL		                                                                                           	#@G00288
	DISPLAY BY NAME l_rec_frm_WZ5.*		                                                                                              	#@G00289
	
														 
																											
													  
#HuHo
	IF modu_cmpy_code IS NULL THEN
		LET modu_cmpy_code = glob_rec_company.cmpy_code
		DISPLAY glob_rec_company.cmpy_code TO location.cmpy_code
		DISPLAY glob_rec_company.name_text TO company.name_text
	ELSE
		DISPLAY modu_cmpy_code TO location.cmpy_code
		DISPLAY db_company_get_name_text(UI_OFF,modu_cmpy_code) TO company.name_text 
	END IF	
#-----																											
		  

	CONSTRUCT BY NAME where_clause ON location.locn_code,		                                                                                                      	#@G00296
	location.desc_text,		                                                                                                      	#@G00296
	location.addr1_text,		                                                                                                     	#@G00296
	location.ware_code,		                                                                                                      	#@G00296
	location.addr2_text,		                                                                                                     	#@G00296
	location.bank_code,		                                                                                                      	#@G00296
	location.city_text,		                                                                                                      	#@G00296
	location.days_to_del,		                                                                                                    	#@G00296
	location.state_code,		                                                                                                     	#@G00296
	location.post_code,		                                                                                                      	#@G00296
	location.country_code,		                                                                                                   	#@G00296
	location.contact_text,		                                                                                                   	#@G00296
	location.tele_text,		                                                                                                      	#@G00296
	location.fax_text,		                                                                                                       	#@G00296
	location.price_high_per,		                                                                                                 	#@G00296
	location.excess_day_num,		                                                                                                 	#@G00296
	location.approval_flag,		                                                                                                  	#@G00296
	location.price_low_per,		                                                                                                  	#@G00296
	location.excess_limit_per,		                                                                                               	#@G00296
	location.summ_cfwd_flag,		                                                                                                 	#@G00296
	location.cart_high_per,		                                                                                                  	#@G00296
	location.price_round_ind,		                                                                                                	#@G00296
	location.edit_km_flag,		                                                                                                   	#@G00296
	location.cart_low_per,		                                                                                                   	#@G00296
	location.disp_locn_ind,		                                                                                                  	#@G00296
	location.min_cartage_ind,		                                                                                                	#@G00296
	location.price_auth_ind,		                                                                                                 	#@G00296
	location.stocktake_ind,		                                                                                                  	#@G00296
	location.head_info_flag,		                                                                                                 	#@G00296
	location.pallet_charge_ind,		                                                                                              	#@G00296
	location.def_labour_class,		                                                                                               	#@G00296
	location.def_int_cust,		                                                                                                   	#@G00296
	location.ol_hold_code,		                                                                                                   	#@G00296
	location.desc2_text,		                                                                                                     	#@G00296
	location.tt_hold_code,		                                                                                                   	#@G00296
	location.comp_date				                                                                                                                         	#@G00297
	
				                                                                                                                         	#@G00298

	## Check whether criteria have been entered		                                                                             	#@G00300
	AFTER CONSTRUCT 		                                                                                                        	#@G00301
		#IF NOT field_touched(location.*) AND NOT int_flag THEN		                                                                 	#@G00302
		#	LET reply = fgl_winbutton("","Select all rows, are you sure?","Yes","Yes|No","question",0)		                            	#@G00303
		#	CASE 		                                                                                                                 	#@G00304
		#	WHEN reply MATCHES "Yes"		                                                                                              	#@G00305
		#		EXIT CONSTRUCT 		                                                                                                      	#@G00306
		#	OTHERWISE # Saisie d'un critere de selection		                                                                          	#@G00307
		#		ERROR "Please input a least one criteria"		                                                                            	#@G00308
		#		CONTINUE CONSTRUCT		                                                                                                   	#@G00309
		#	END CASE		                                                                                                              	#@G00310
		#END IF		                                                                                                                 	#@G00311
	END CONSTRUCT		                                                                                                           	#@G00312

	IF int_flag = TRUE THEN		                                                                                                 	#@G00314
		MESSAGE "Quit with quit key"		                                                                                           	#@G00315
		LET int_flag=0		                                                                                                         	#@G00316
	ELSE		                                                                                                                    	#@G00317
		LET xnumber = sql_get_qbe_count_location(where_clause)		                                                                 	#@G00318
		IF xnumber > 0 THEN		                                                                                                    	#@G00319
			LET sql_stmt_status = sql_opn_pky_scr_curs_location(where_clause)		                                                     	#@G00320
		ELSE		                                                                                                                   	#@G00321
			RETURN -1		                                                                                                             	#@G00322
		END IF		                                                                                                                 	#@G00323
			
	END IF		                                                                                                                  	#@G00325
	RETURN xnumber		                                                                                                          	#@G00326
END FUNCTION ## Query_location		                                                                                           	#@G00327

#######################################################################		                                                  	#@G00329
# frm_Display_WZ5_W120 : displays the form record AFTER reading and displays lookup records if any		                      	#@G00330
# inbound: Form record.*		                                                                                                 	#@G00331
FUNCTION frm_Display_WZ5(l_rec_frm_WZ5)		                                                                                      	#@G00332
	DEFINE l_rec_frm_WZ5 RECORD 		                                                                                                 	#@G00333
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G00333
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G00333
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G00333
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G00333
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G00333
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G00333
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G00333
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G00333
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G00333
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G00333
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G00333
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G00333
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G00333
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G00333
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G00333
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G00333
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G00333
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G00333
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G00333
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G00333
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G00333
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G00333
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G00333
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G00333
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G00333
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G00333
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G00333
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G00333
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G00333
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G00333
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G00333
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G00333
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G00333
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G00333
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G00333
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G00333
		comp_date LIKE location.comp_date #  date		                                                                                	#@G00333
				                                                                                                                         	#@G00334
	END RECORD		                                                                                                              	#@G00335

	DEFINE lookup_status INTEGER		                                                                                             	#@G00337
	DEFINE lku_bank RECORD		                                                                                                   	#@G00337
		name_acct_text LIKE bank.name_acct_text #  nvarchar(40)		                                                                  	#@G00337
	
	END RECORD		                                                                                                             	#@G00338
	DEFINE lku_warehouse RECORD		                                                                                              	#@G00338
		desc_text LIKE warehouse.desc_text #  nvarchar(30)		                                                                       	#@G00338
	
	END RECORD		                                                                                                             	#@G00339
			                                                                                                                         	#@G00339
	CLEAR FORM		                                                                                                              	#@G00340
	DISPLAY BY NAME l_rec_frm_WZ5.*		                                                                                              	#@G00341

	IF l_rec_frm_WZ5.cmpy_code IS NOT NULL AND l_rec_frm_WZ5.ware_code IS NOT NULL THEN		                                                	#@G00342
		CALL lookup_location_warehouse(l_rec_frm_WZ5.cmpy_code,l_rec_frm_WZ5.ware_code)		                                                    	#@G00343
		RETURNING lookup_status,		                                                                                                 	#@G00343
		lku_warehouse.desc_text				                                                                                                                         	#@G00344
		CASE		                                                                                                                     	#@G00345
		WHEN lookup_status = 0		                                                                                                   	#@G00346
			DISPLAY 		                                                                                                                 	#@G00346
			lku_warehouse.desc_text					                                                                                                                         	#@G00347
			TO 			warehouse.desc_text					                                                                                                                         	#@G00348
		WHEN lookup_status = 100		                                                                                                 	#@G00349
			ERROR " "		                                                                                                                	#@G00350
			#NEXT FIELD cmpy_code		                                                                                                     	#@G00351
		WHEN lookup_status < 0		                                                                                                   	#@G00352
			ERROR " "		                                                                                                                	#@G00353
			#NEXT FIELD cmpy_code		                                                                                                     	#@G00354
		END CASE		                                                                                                                 	#@G00355
	END IF		                                                                                                                   	#@G00356
	IF l_rec_frm_WZ5.cmpy_code IS NOT NULL AND l_rec_frm_WZ5.bank_code IS NOT NULL THEN		                                                	#@G00356
		CALL lookup_location_bank(l_rec_frm_WZ5.cmpy_code,l_rec_frm_WZ5.bank_code)		                                                         	#@G00357
		RETURNING lookup_status,		                                                                                                 	#@G00357
		lku_bank.name_acct_text				                                                                                                                         	#@G00358
		CASE		                                                                                                                     	#@G00359
		WHEN lookup_status = 0		                                                                                                   	#@G00360
			DISPLAY 		                                                                                                                 	#@G00360
			lku_bank.name_acct_text					                                                                                                                         	#@G00361
			TO 			bank.name_acct_text					                                                                                                                         	#@G00362
		WHEN lookup_status = 100		                                                                                                 	#@G00363
			ERROR " "		                                                                                                                	#@G00364
			#NEXT FIELD cmpy_code		                                                                                                     	#@G00365
		WHEN lookup_status < 0		                                                                                                   	#@G00366
			ERROR " "		                                                                                                                	#@G00367
			#NEXT FIELD cmpy_code		                                                                                                     	#@G00368
		END CASE		                                                                                                                 	#@G00369
	END IF		                                                                                                                   	#@G00370
	
#DISPLAY BY NAME lku_warehouse.desc_text,		                                                                                                 	#@G00372
#	lku_bank.name_acct_text				                                                                                                                         	#@G00372

END FUNCTION # frm_Display_WZ5_W120		                                                                                     	#@G00374


####################################################################		                                                     	#@G00377
## frm_Insert_WZ5_W120: add a new location row		                                                                          	#@G00378
FUNCTION frm_Insert_WZ5(p_cmpy_code)		                                                                                               	#@G00379
	DEFINE p_cmpy_code LIKE kandoouser.cmpy_code
	DEFINE sql_stmt_status SMALLINT		                                                                                         	#@G00380
	DEFINE rows_count SMALLINT		                                                                                              	#@G00381
	DEFINE nbre_location ,action SMALLINT		                                                                                   	#@G00382
	DEFINE l_rec_frm_WZ5 RECORD 		                                                                                                 	#@G00383
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G00383
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G00383
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G00383
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G00383
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G00383
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G00383
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G00383
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G00383
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G00383
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G00383
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G00383
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G00383
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G00383
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G00383
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G00383
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G00383
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G00383
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G00383
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G00383
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G00383
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G00383
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G00383
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G00383
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G00383
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G00383
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G00383
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G00383
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G00383
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G00383
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G00383
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G00383
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G00383
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G00383
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G00383
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G00383
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G00383
		comp_date LIKE location.comp_date #  date		                                                                                	#@G00383
				                                                                                                                         	#@G00384
	END RECORD		                                                                                                              	#@G00385

	DEFINE l_rec_tbl_WZ5 RECORD 		                                                                                                 	#@G00387
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00387
		locn_code LIKE location.locn_code, # nchar(3)		                                                                            	#@G00387
		desc_text LIKE location.desc_text, # nvarchar(40)		                                                                        	#@G00387
		addr1_text LIKE location.addr1_text, # nvarchar(40)		                                                                      	#@G00387
		addr2_text LIKE location.addr2_text, # nvarchar(40)		                                                                      	#@G00387
		city_text LIKE location.city_text, # nvarchar(40)		                                                                        	#@G00387
		state_code LIKE location.state_code, # nvarchar(6)		                                                                       	#@G00387
		post_code LIKE location.post_code, # nvarchar(10)		                                                                        	#@G00387
		country_code LIKE location.country_code, # nchar(3)		                                                                      	#@G00387
		contact_text LIKE location.contact_text, # nvarchar(40)		                                                                  	#@G00387
		tele_text LIKE location.tele_text, # nvarchar(20)		                                                                        	#@G00387
		fax_text LIKE location.fax_text, # nvarchar(20)		                                                                          	#@G00387
		ware_code LIKE location.ware_code, # nchar(3)		                                                                            	#@G00387
		price_high_per LIKE location.price_high_per, # DECIMAL		                                                                   	#@G00387
		price_low_per LIKE location.price_low_per, # DECIMAL		                                                                     	#@G00387
		cart_high_per LIKE location.cart_high_per, # DECIMAL		                                                                     	#@G00387
		cart_low_per LIKE location.cart_low_per, # DECIMAL		                                                                       	#@G00387
		other_high_per LIKE location.other_high_per, # DECIMAL		                                                                   	#@G00387
		other_low_per LIKE location.other_low_per, # DECIMAL		                                                                     	#@G00387
		price_auth_ind LIKE location.price_auth_ind, # nchar(1)		                                                                  	#@G00387
		pallet_charge_ind LIKE location.pallet_charge_ind, # nchar(1)		                                                            	#@G00387
		bank_code LIKE location.bank_code, # nvarchar(9)		                                                                         	#@G00387
		days_to_del LIKE location.days_to_del, # smallint		                                                                        	#@G00387
		ol_hold_code LIKE location.ol_hold_code, # nchar(3)		                                                                      	#@G00387
		tt_hold_code LIKE location.tt_hold_code, # nchar(3)		                                                                      	#@G00387
		oltt_hold_code LIKE location.oltt_hold_code, # nchar(3)		                                                                  	#@G00387
		excess_day_num LIKE location.excess_day_num, # smallint		                                                                  	#@G00387
		excess_limit_per LIKE location.excess_limit_per, # smallint		                                                              	#@G00387
		price_round_ind LIKE location.price_round_ind, # nchar(1)		                                                                	#@G00387
		disp_locn_ind LIKE location.disp_locn_ind, # nchar(1)		                                                                    	#@G00387
		stocktake_ind LIKE location.stocktake_ind, # nchar(1)		                                                                    	#@G00387
		def_labour_class LIKE location.def_labour_class, # nvarchar(8)		                                                           	#@G00387
		desc2_text LIKE location.desc2_text, # nvarchar(60)		                                                                      	#@G00387
		comp_date LIKE location.comp_date, # date		                                                                                	#@G00387
		approval_flag LIKE location.approval_flag, # nchar(1)		                                                                    	#@G00387
		summ_cfwd_flag LIKE location.summ_cfwd_flag, # nchar(1)		                                                                  	#@G00387
		edit_km_flag LIKE location.edit_km_flag, # nchar(1)		                                                                      	#@G00387
		min_cartage_ind LIKE location.min_cartage_ind, # nchar(1)		                                                                	#@G00387
		head_info_flag LIKE location.head_info_flag, # nchar(1)		                                                                  	#@G00387
		def_int_cust LIKE location.def_int_cust # nvarchar(8)				                                                                                                                         	#@G00388
	END RECORD		                                                                                                              	#@G00389
	
	DEFINE lookup_status INTEGER		                                                                                             	#@G00391
	DEFINE lku_bank RECORD		                                                                                                   	#@G00391
		name_acct_text LIKE bank.name_acct_text #  nvarchar(40)		                                                                  	#@G00391
	
	END RECORD		                                                                                                             	#@G00392
	DEFINE lku_warehouse RECORD		                                                                                              	#@G00392
		desc_text LIKE warehouse.desc_text #  nvarchar(30)		                                                                       	#@G00392
	
	END RECORD		                                                                                                             	#@G00393
			                                                                                                                         	#@G00393

	CLEAR FORM		                                                                                                              	#@G00395
	INITIALIZE l_rec_frm_WZ5.* TO NULL		                                                                                           	#@G00396

										  
	#huho						
###############
# IF COMPANY_CODE was specified as program launch argument, it will be used to overwrite users cmpy_code
#Huho
	LET modu_cmpy_code = get_url_company_code()
		
	IF modu_cmpy_code IS NULL THEN #if not specified, use users's cmpy_code
		LET modu_cmpy_code = glob_rec_kandoouser.cmpy_code
	END IF


	LET l_rec_frm_WZ5.cmpy_code = p_cmpy_code																												 
	DISPLAY l_rec_frm_WZ5.cmpy_code TO cmpy_code
	DISPLAY db_company_get_name_text(UI_OFF,p_cmpy_code) TO company.name_text
	##################
			  
	WHILE true		                                                                                                              	#@G00401
		LET int_flag = false		                                                                                                   	#@G00402
		INPUT BY NAME l_rec_frm_WZ5.locn_code,		                                                                                                      	#@G00402
		l_rec_frm_WZ5.desc_text,		                                                                                                      	#@G00402
		l_rec_frm_WZ5.addr1_text,		                                                                                                     	#@G00402
		l_rec_frm_WZ5.ware_code,		                                                                                                      	#@G00402
		l_rec_frm_WZ5.addr2_text,		                                                                                                     	#@G00402
		l_rec_frm_WZ5.bank_code,		                                                                                                      	#@G00402
		l_rec_frm_WZ5.city_text,		                                                                                                      	#@G00402
		l_rec_frm_WZ5.days_to_del,		                                                                                                    	#@G00402
		l_rec_frm_WZ5.state_code,		                                                                                                     	#@G00402
		l_rec_frm_WZ5.post_code,		                                                                                                      	#@G00402
		l_rec_frm_WZ5.country_code,		                                                                                                   	#@G00402
		l_rec_frm_WZ5.contact_text,		                                                                                                   	#@G00402
		l_rec_frm_WZ5.tele_text,		                                                                                                      	#@G00402
		l_rec_frm_WZ5.fax_text,		                                                                                                       	#@G00402
		l_rec_frm_WZ5.price_high_per,		                                                                                                 	#@G00402
		l_rec_frm_WZ5.excess_day_num,		                                                                                                 	#@G00402
		l_rec_frm_WZ5.approval_flag,		                                                                                                  	#@G00402
		l_rec_frm_WZ5.price_low_per,		                                                                                                  	#@G00402
		l_rec_frm_WZ5.excess_limit_per,		                                                                                               	#@G00402
		l_rec_frm_WZ5.summ_cfwd_flag,		                                                                                                 	#@G00402
		l_rec_frm_WZ5.cart_high_per,		                                                                                                  	#@G00402
		l_rec_frm_WZ5.price_round_ind,		                                                                                                	#@G00402
		l_rec_frm_WZ5.edit_km_flag,		                                                                                                   	#@G00402
		l_rec_frm_WZ5.cart_low_per,		                                                                                                   	#@G00402
		l_rec_frm_WZ5.disp_locn_ind,		                                                                                                  	#@G00402
		l_rec_frm_WZ5.min_cartage_ind,		                                                                                                	#@G00402
		l_rec_frm_WZ5.price_auth_ind,		                                                                                                 	#@G00402
		l_rec_frm_WZ5.stocktake_ind,		                                                                                                  	#@G00402
		l_rec_frm_WZ5.head_info_flag,		                                                                                                 	#@G00402
		l_rec_frm_WZ5.pallet_charge_ind,		                                                                                              	#@G00402
		l_rec_frm_WZ5.def_labour_class,		                                                                                               	#@G00402
		l_rec_frm_WZ5.def_int_cust,		                                                                                                   	#@G00402
		l_rec_frm_WZ5.ol_hold_code,		                                                                                                   	#@G00402
		l_rec_frm_WZ5.desc2_text,		                                                                                                     	#@G00402
		l_rec_frm_WZ5.tt_hold_code,		                                                                                                   	#@G00402
		l_rec_frm_WZ5.comp_date						                                                                                                                         	#@G00403
		WITHOUT DEFAULTS		                                                                                                       	#@G00404
			AFTER FIELD locn_code		                                                                                                   	#@G00405
				IF l_rec_frm_WZ5.locn_code IS NULL THEN		                                                                                     	#@G00406
					ERROR "This field is required"		                                                                                        	#@G00407
					NEXT FIELD locn_code		                                                                                                  	#@G00408
				END IF		                                                                                                                 	#@G00409
			IF sql_status_pk_location(l_rec_frm_WZ5.cmpy_code,l_rec_frm_WZ5.locn_code) THEN		                                                   	#@G00410
				ERROR "location: already exists"		                                                                                       	#@G00411
				NEXT FIELD locn_code		                                                                                                   	#@G00412
			END IF		                                                                                                                  	#@G00413
			AFTER FIELD ware_code		                                                                                                   	#@G00414
			IF l_rec_frm_WZ5.cmpy_code IS NOT NULL AND l_rec_frm_WZ5.ware_code IS NOT NULL THEN		                                                	#@G00414
				CALL lookup_location_warehouse(l_rec_frm_WZ5.cmpy_code,l_rec_frm_WZ5.ware_code)		                                                    	#@G00415
				RETURNING lookup_status,		                                                                                                 	#@G00415
				lku_warehouse.desc_text						                                                                                                                         	#@G00416
				CASE		                                                                                                                     	#@G00417
				WHEN lookup_status = 0		                                                                                                   	#@G00418
					DISPLAY 		                                                                                                                 	#@G00418
					lku_warehouse.desc_text							                                                                                                                         	#@G00419
					TO 					warehouse.desc_text							                                                                                                                         	#@G00420
				WHEN lookup_status = 100		                                                                                                 	#@G00421
#					ERROR " "		                                                                                                                	#@G00422
					NEXT FIELD ware_code #huho was cmpy_code 		                                                                                                     	#@G00423
				WHEN lookup_status < 0		                                                                                                   	#@G00424
#					ERROR " "		                                                                                                                	#@G00425
					NEXT FIELD ware_code	 #huho was cmpy_code 		                                                                                                     	#@G00426
				END CASE		                                                                                                                 	#@G00427
			END IF		                                                                                                                   	#@G00428
			AFTER FIELD bank_code		                                                                                                   	#@G00429
			IF l_rec_frm_WZ5.cmpy_code IS NOT NULL AND l_rec_frm_WZ5.bank_code IS NOT NULL THEN		                                                	#@G00429
				CALL lookup_location_bank(l_rec_frm_WZ5.cmpy_code,l_rec_frm_WZ5.bank_code)		                                                         	#@G00430
				RETURNING lookup_status,		                                                                                                 	#@G00430
				lku_bank.name_acct_text						                                                                                                                         	#@G00431
				CASE		                                                                                                                     	#@G00432
				WHEN lookup_status = 0		                                                                                                   	#@G00433
					DISPLAY 		                                                                                                                 	#@G00433
					lku_bank.name_acct_text							                                                                                                                         	#@G00434
					TO 					bank.name_acct_text							                                                                                                                         	#@G00435
				WHEN lookup_status = 100		                                                                                                 	#@G00436
					ERROR " "		                                                                                                                	#@G00437
					NEXT FIELD bank_code		                                                                                                     	#@G00438
				WHEN lookup_status < 0		                                                                                                   	#@G00439
					ERROR " "		                                                                                                                	#@G00440
					NEXT FIELD bank_code		                                                                                                     	#@G00441
				END CASE		                                                                                                                 	#@G00442
			END IF		                                                                                                                   	#@G00443
				                                                                                                                         	#@G00443
		
				                                                                                                                         	#@G00444
				                                                                                                                         	#@G00444
		END INPUT		                                                                                                              	#@G00445
		IF int_flag = TRUE THEN		                                                                                                	#@G00446
			# Resign from input		                                                                                                   	#@G00447
			LET int_flag=false		                                                                                                    	#@G00448
			DISPLAY BY NAME l_rec_frm_WZ5.*		                                                                                            	#@G00449
			MESSAGE "Quit with quit key Control-C"		                                                                                	#@G00450
			EXIT WHILE		                                                                                                            	#@G00451
		END IF 		                                                                                                                	#@G00452

		CALL confirm_operation(3,10,"Insert") RETURNING action		                                                                 	#@G00454
		CASE action		                                                                                                            	#@G00455
		WHEN 0 # I want to edit the input, remains displayed 'as is'		                                                           	#@G00456
			CONTINUE WHILE # On laisse tout affiche comme tel		                                                                     	#@G00457
			
		WHEN 2 # On valide la transaction		                                                                                      	#@G00459
			BEGIN WORK		                                                                                                               	#@G00460
					                                                                                                                         	#@G00460
			CALL set_table_record_W120_location(1,l_rec_frm_WZ5.*)		                                                                     	#@G00461
			RETURNING l_rec_tbl_WZ5.*		                                                                                                  	#@G00462
			CALL sql_Insert_location(l_rec_tbl_WZ5.*) 		                                                                                 	#@G00463
			returning sql_stmt_status,			l_rec_tbl_WZ5.cmpy_code,l_rec_tbl_WZ5.locn_code					                                                                                                                         	#@G00464

			CASE 		                                                                                                                 	#@G00466
			WHEN sql_stmt_status = 0		                                                                                              	#@G00467
				MESSAGE "Insert location Successful operation"		                                                                       	#@G00468
				COMMIT WORK		                                                                                                              	#@G00469
						                                                                                                                         	#@G00469
			WHEN sql_stmt_status < 0		                                                                                              	#@G00470
				CALL display_db_error("Insert location:failed ")		                                                                        	#@G00471
				ROLLBACK WORK		                                                                                                            	#@G00472
						                                                                                                                         	#@G00472
			END CASE		                                                                                                              	#@G00473
			EXIT WHILE		                                                                                                            	#@G00474

		WHEN 0		                                                                                                                 	#@G00476
			ROLLBACK WORK		                                                                                                            	#@G00477
					                                                                                                                         	#@G00477
			EXIT WHILE		                                                                                                            	#@G00478
		END CASE		                                                                                                               	#@G00479
	END WHILE		                                                                                                               	#@G00480
	# l_rec_tbl_WZ5		                                                                                                              	#@G00481
	RETURN sql_stmt_status,	l_rec_tbl_WZ5.cmpy_code,l_rec_tbl_WZ5.locn_code			                                                                                                                         	#@G00482
END FUNCTION ## frm_Insert_WZ5_W120		                                                                                     	#@G00483


#######################################################################		                                                  	#@G00486
# frm_Edit_WZ5_W120 : Edit a location RECORD		                                                                            	#@G00487
# inbound: table primary key		                                                                                             	#@G00488
FUNCTION frm_Edit_WZ5(pky,l_rec_frm_WZ5)		                                                                                     	#@G00489
	DEFINE action SMALLINT 		                                                                                                 	#@G00490
	DEFINE sql_stmt_status,dummy SMALLINT		                                                                                   	#@G00491

	DEFINE l_rec_tbl_WZ5 RECORD 		                                                                                                 	#@G00493
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00493
		locn_code LIKE location.locn_code, # nchar(3)		                                                                            	#@G00493
		desc_text LIKE location.desc_text, # nvarchar(40)		                                                                        	#@G00493
		addr1_text LIKE location.addr1_text, # nvarchar(40)		                                                                      	#@G00493
		addr2_text LIKE location.addr2_text, # nvarchar(40)		                                                                      	#@G00493
		city_text LIKE location.city_text, # nvarchar(40)		                                                                        	#@G00493
		state_code LIKE location.state_code, # nvarchar(6)		                                                                       	#@G00493
		post_code LIKE location.post_code, # nvarchar(10)		                                                                        	#@G00493
		country_code LIKE location.country_code, # nchar(3)		                                                                      	#@G00493
		contact_text LIKE location.contact_text, # nvarchar(40)		                                                                  	#@G00493
		tele_text LIKE location.tele_text, # nvarchar(20)		                                                                        	#@G00493
		fax_text LIKE location.fax_text, # nvarchar(20)		                                                                          	#@G00493
		ware_code LIKE location.ware_code, # nchar(3)		                                                                            	#@G00493
		price_high_per LIKE location.price_high_per, # DECIMAL		                                                                   	#@G00493
		price_low_per LIKE location.price_low_per, # DECIMAL		                                                                     	#@G00493
		cart_high_per LIKE location.cart_high_per, # DECIMAL		                                                                     	#@G00493
		cart_low_per LIKE location.cart_low_per, # DECIMAL		                                                                       	#@G00493
		other_high_per LIKE location.other_high_per, # DECIMAL		                                                                   	#@G00493
		other_low_per LIKE location.other_low_per, # DECIMAL		                                                                     	#@G00493
		price_auth_ind LIKE location.price_auth_ind, # nchar(1)		                                                                  	#@G00493
		pallet_charge_ind LIKE location.pallet_charge_ind, # nchar(1)		                                                            	#@G00493
		bank_code LIKE location.bank_code, # nvarchar(9)		                                                                         	#@G00493
		days_to_del LIKE location.days_to_del, # smallint		                                                                        	#@G00493
		ol_hold_code LIKE location.ol_hold_code, # nchar(3)		                                                                      	#@G00493
		tt_hold_code LIKE location.tt_hold_code, # nchar(3)		                                                                      	#@G00493
		oltt_hold_code LIKE location.oltt_hold_code, # nchar(3)		                                                                  	#@G00493
		excess_day_num LIKE location.excess_day_num, # smallint		                                                                  	#@G00493
		excess_limit_per LIKE location.excess_limit_per, # smallint		                                                              	#@G00493
		price_round_ind LIKE location.price_round_ind, # nchar(1)		                                                                	#@G00493
		disp_locn_ind LIKE location.disp_locn_ind, # nchar(1)		                                                                    	#@G00493
		stocktake_ind LIKE location.stocktake_ind, # nchar(1)		                                                                    	#@G00493
		def_labour_class LIKE location.def_labour_class, # nvarchar(8)		                                                           	#@G00493
		desc2_text LIKE location.desc2_text, # nvarchar(60)		                                                                      	#@G00493
		comp_date LIKE location.comp_date, # date		                                                                                	#@G00493
		approval_flag LIKE location.approval_flag, # nchar(1)		                                                                    	#@G00493
		summ_cfwd_flag LIKE location.summ_cfwd_flag, # nchar(1)		                                                                  	#@G00493
		edit_km_flag LIKE location.edit_km_flag, # nchar(1)		                                                                      	#@G00493
		min_cartage_ind LIKE location.min_cartage_ind, # nchar(1)		                                                                	#@G00493
		head_info_flag LIKE location.head_info_flag, # nchar(1)		                                                                  	#@G00493
		def_int_cust LIKE location.def_int_cust # nvarchar(8)				                                                                                                                         	#@G00494
	END RECORD		                                                                                                              	#@G00495

	DEFINE l_rec_frm_WZ5 RECORD 		                                                                                                 	#@G00497
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G00497
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G00497
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G00497
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G00497
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G00497
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G00497
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G00497
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G00497
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G00497
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G00497
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G00497
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G00497
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G00497
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G00497
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G00497
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G00497
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G00497
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G00497
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G00497
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G00497
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G00497
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G00497
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G00497
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G00497
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G00497
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G00497
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G00497
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G00497
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G00497
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G00497
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G00497
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G00497
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G00497
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G00497
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G00497
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G00497
		comp_date LIKE location.comp_date #  date		                                                                                	#@G00497
				                                                                                                                         	#@G00498
	END RECORD		                                                                                                              	#@G00499

	DEFINE sav_WZ5 RECORD 		                                                                                                 	#@G00501
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G00501
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G00501
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G00501
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G00501
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G00501
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G00501
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G00501
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G00501
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G00501
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G00501
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G00501
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G00501
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G00501
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G00501
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G00501
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G00501
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G00501
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G00501
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G00501
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G00501
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G00501
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G00501
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G00501
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G00501
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G00501
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G00501
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G00501
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G00501
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G00501
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G00501
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G00501
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G00501
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G00501
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G00501
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G00501
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G00501
		comp_date LIKE location.comp_date #  date		                                                                                	#@G00501
				                                                                                                                         	#@G00502
	END RECORD		                                                                                                              	#@G00503
	DEFINE lookup_status INTEGER		                                                                                             	#@G00504
			                                                                                                                         	#@G00504
	DEFINE rows_count SMALLINT		                                                                                              	#@G00505
	DEFINE pky RECORD 		                                                                                                      	#@G00506
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00506
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00507
	END RECORD		                                                                                                              	#@G00508

	## check if record can be accessed		                                                                                      	#@G00510
	WHILE true		                                                                                                              	#@G00511
		LET int_flag = false		                                                                                                   	#@G00512
		# Save Screen Record values before altering		                                                                            	#@G00513
		LET sav_WZ5.* = l_rec_frm_WZ5.* 		                                                                                           	#@G00514
		BEGIN WORK		                                                                                                               	#@G00515
		EXECUTE IMMEDIATE "SET ISOLATION TO COMMITTED READ RETAIN UPDATE LOCKS"		                                                  	#@G00516
		WHENEVER ERROR CONTINUE		                                                                                                  	#@G00517
		OPEN crs_upd_location USING pky.*		                                                                                        	#@G00517
		FETCH crs_upd_location INTO dummy		                                                                                        	#@G00517
		IF sqlca.sqlcode = -244 THEN ERROR "THIS ROW IS BEING MODIFIED"
			ROLLBACK WORK EXIT WHILE END IF		                       	#@G00521
		WHENEVER ERROR STOP		                                                                                                      	#@G00522
				                                                                                                                         	#@G00522
		
		INPUT BY NAME l_rec_frm_WZ5.desc_text,		                                                                                                      	#@G00523
		l_rec_frm_WZ5.addr1_text,		                                                                                                     	#@G00523
		l_rec_frm_WZ5.ware_code,		                                                                                                      	#@G00523
		l_rec_frm_WZ5.addr2_text,		                                                                                                     	#@G00523
		l_rec_frm_WZ5.bank_code,		                                                                                                      	#@G00523
		l_rec_frm_WZ5.city_text,		                                                                                                      	#@G00523
		l_rec_frm_WZ5.days_to_del,		                                                                                                    	#@G00523
		l_rec_frm_WZ5.state_code,		                                                                                                     	#@G00523
		l_rec_frm_WZ5.post_code,		                                                                                                      	#@G00523
		l_rec_frm_WZ5.country_code,		                                                                                                   	#@G00523
		l_rec_frm_WZ5.contact_text,		                                                                                                   	#@G00523
		l_rec_frm_WZ5.tele_text,		                                                                                                      	#@G00523
		l_rec_frm_WZ5.fax_text,		                                                                                                       	#@G00523
		l_rec_frm_WZ5.price_high_per,		                                                                                                 	#@G00523
		l_rec_frm_WZ5.excess_day_num,		                                                                                                 	#@G00523
		l_rec_frm_WZ5.approval_flag,		                                                                                                  	#@G00523
		l_rec_frm_WZ5.price_low_per,		                                                                                                  	#@G00523
		l_rec_frm_WZ5.excess_limit_per,		                                                                                               	#@G00523
		l_rec_frm_WZ5.summ_cfwd_flag,		                                                                                                 	#@G00523
		l_rec_frm_WZ5.cart_high_per,		                                                                                                  	#@G00523
		l_rec_frm_WZ5.price_round_ind,		                                                                                                	#@G00523
		l_rec_frm_WZ5.edit_km_flag,		                                                                                                   	#@G00523
		l_rec_frm_WZ5.cart_low_per,		                                                                                                   	#@G00523
		l_rec_frm_WZ5.disp_locn_ind,		                                                                                                  	#@G00523
		l_rec_frm_WZ5.min_cartage_ind,		                                                                                                	#@G00523
		l_rec_frm_WZ5.price_auth_ind,		                                                                                                 	#@G00523
		l_rec_frm_WZ5.stocktake_ind,		                                                                                                  	#@G00523
		l_rec_frm_WZ5.head_info_flag,		                                                                                                 	#@G00523
		l_rec_frm_WZ5.pallet_charge_ind,		                                                                                              	#@G00523
		l_rec_frm_WZ5.def_labour_class,		                                                                                               	#@G00523
		l_rec_frm_WZ5.def_int_cust,		                                                                                                   	#@G00523
		l_rec_frm_WZ5.ol_hold_code,		                                                                                                   	#@G00523
		l_rec_frm_WZ5.desc2_text,		                                                                                                     	#@G00523
		l_rec_frm_WZ5.tt_hold_code,		                                                                                                   	#@G00523
		l_rec_frm_WZ5.comp_date						                                                                                                                         	#@G00524
		WITHOUT DEFAULTS		                                                                                                       	#@G00525
			AFTER FIELD ware_code		                                                                                                   	#@G00526
			IF l_rec_frm_WZ5.cmpy_code IS NOT NULL AND l_rec_frm_WZ5.ware_code IS NOT NULL THEN		                                                	#@G00526
				CALL lookup_location_warehouse(l_rec_frm_WZ5.cmpy_code,l_rec_frm_WZ5.ware_code)		                                                    	#@G00527
				RETURNING lookup_status,		                                                                                                 	#@G00527
				lku_warehouse.desc_text						                                                                                                                         	#@G00528
				CASE		                                                                                                                     	#@G00529
				WHEN lookup_status = 0		                                                                                                   	#@G00530
					DISPLAY 		                                                                                                                 	#@G00530
					lku_warehouse.desc_text							                                                                                                                         	#@G00531
					TO 					warehouse.desc_text							                                                                                                                         	#@G00532
				WHEN lookup_status = 100		                                                                                                 	#@G00533
					ERROR " "		                                                                                                                	#@G00534
					NEXT FIELD cmpy_code		                                                                                                     	#@G00535
				WHEN lookup_status < 0		                                                                                                   	#@G00536
					ERROR " "		                                                                                                                	#@G00537
					NEXT FIELD cmpy_code		                                                                                                     	#@G00538
				END CASE		                                                                                                                 	#@G00539
			END IF		                                                                                                                   	#@G00540
			AFTER FIELD bank_code		                                                                                                   	#@G00541
			IF l_rec_frm_WZ5.cmpy_code IS NOT NULL AND l_rec_frm_WZ5.bank_code IS NOT NULL THEN		                                                	#@G00541
				CALL lookup_location_bank(l_rec_frm_WZ5.cmpy_code,l_rec_frm_WZ5.bank_code)		                                                         	#@G00542
				RETURNING lookup_status,		                                                                                                 	#@G00542
				lku_bank.name_acct_text						                                                                                                                         	#@G00543
				CASE		                                                                                                                     	#@G00544
				WHEN lookup_status = 0		                                                                                                   	#@G00545
					DISPLAY 		                                                                                                                 	#@G00545
					lku_bank.name_acct_text							                                                                                                                         	#@G00546
					TO 					bank.name_acct_text							                                                                                                                         	#@G00547
				WHEN lookup_status = 100		                                                                                                 	#@G00548
					ERROR " "		                                                                                                                	#@G00549
					NEXT FIELD cmpy_code		                                                                                                     	#@G00550
				WHEN lookup_status < 0		                                                                                                   	#@G00551
					ERROR " "		                                                                                                                	#@G00552
					NEXT FIELD cmpy_code		                                                                                                     	#@G00553
				END CASE		                                                                                                                 	#@G00554
			END IF		                                                                                                                   	#@G00555
				                                                                                                                         	#@G00555

				                                                                                                                         	#@G00556
					
				                                                                                                                         	#@G00557
		END INPUT		                                                                                                              	#@G00558
		IF int_flag = TRUE THEN		                                                                                                	#@G00559
			LET int_flag=false		                                                                                                    	#@G00560
			# Restore previous value		                                                                                              	#@G00561
			LET l_rec_frm_WZ5.* = sav_WZ5.*		                                                                                           	#@G00562
			DISPLAY BY NAME l_rec_frm_WZ5.*		                                                                                            	#@G00563
				IF l_rec_frm_WZ5.cmpy_code IS NOT NULL AND l_rec_frm_WZ5.ware_code IS NOT NULL THEN		                                                	#@G00563
					CALL lookup_location_warehouse(l_rec_frm_WZ5.cmpy_code,l_rec_frm_WZ5.ware_code)		                                                    	#@G00564
					RETURNING lookup_status,		                                                                                                 	#@G00564
					lku_warehouse.desc_text							                                                                                                                         	#@G00565
					CASE		                                                                                                                     	#@G00566
					WHEN lookup_status = 0		                                                                                                   	#@G00567
						DISPLAY 		                                                                                                                 	#@G00567
						lku_warehouse.desc_text								                                                                                                                         	#@G00568
						TO 						warehouse.desc_text								                                                                                                                         	#@G00569
					WHEN lookup_status = 100		                                                                                                 	#@G00570
						ERROR " "		                                                                                                                	#@G00571
						#NEXT FIELD cmpy_code		                                                                                                     	#@G00572
					WHEN lookup_status < 0		                                                                                                   	#@G00573
						ERROR " "		                                                                                                                	#@G00574
						#NEXT FIELD cmpy_code		                                                                                                     	#@G00575
					END CASE		                                                                                                                 	#@G00576
				END IF		                                                                                                                   	#@G00577
				IF l_rec_frm_WZ5.cmpy_code IS NOT NULL AND l_rec_frm_WZ5.bank_code IS NOT NULL THEN		                                                	#@G00577
					CALL lookup_location_bank(l_rec_frm_WZ5.cmpy_code,l_rec_frm_WZ5.bank_code)		                                                         	#@G00578
					RETURNING lookup_status,		                                                                                                 	#@G00578
					lku_bank.name_acct_text							                                                                                                                         	#@G00579
					CASE		                                                                                                                     	#@G00580
					WHEN lookup_status = 0		                                                                                                   	#@G00581
						DISPLAY 		                                                                                                                 	#@G00581
						lku_bank.name_acct_text								                                                                                                                         	#@G00582
						TO 						bank.name_acct_text								                                                                                                                         	#@G00583
					WHEN lookup_status = 100		                                                                                                 	#@G00584
						ERROR " "		                                                                                                                	#@G00585
						#NEXT FIELD cmpy_code		                                                                                                     	#@G00586
					WHEN lookup_status < 0		                                                                                                   	#@G00587
						ERROR " "		                                                                                                                	#@G00588
						#NEXT FIELD cmpy_code		                                                                                                     	#@G00589
					END CASE		                                                                                                                 	#@G00590
				END IF		                                                                                                                   	#@G00591
			DISPLAY BY NAME lku_warehouse.desc_text,		                                                                                                 	#@G00592
			lku_bank.name_acct_text								                                                                                                                         	#@G00592
			EXECUTE IMMEDIATE "SET ISOLATION TO COMMITTED READ"		                                                                   	#@G00593
			ROLLBACK WORK		                                                                                                         	#@G00594
			MESSAGE "$CancelCom Control-C"		                                                                                        	#@G00595
			EXIT WHILE		                                                                                                            	#@G00596
		END IF 		                                                                                                                	#@G00597

		CALL confirm_operation(4,10,MODE_CLASSIC_EDIT) RETURNING action		                                                                   	#@G00599

		CASE 		                                                                                                                  	#@G00601
		WHEN action = 0		                                                                                                        	#@G00602
			# Redo, leave values as modified		                                                                                      	#@G00603
			CONTINUE WHILE		                                                                                                        	#@G00604
		WHEN action = 1 		                                                                                                       	#@G00605
			# Resign, restore original values		                                                                                     	#@G00606
			LET l_rec_frm_WZ5.* = sav_WZ5.*		                                                                                           	#@G00607
			DISPLAY BY NAME l_rec_frm_WZ5.*		                                                                                            	#@G00608
			EXECUTE IMMEDIATE "SET ISOLATION TO COMMITTED READ"		                                                                   	#@G00609
			ROLLBACK WORK		                                                                                                         	#@G00610
			EXIT WHILE # Cancel operation		                                                                                         	#@G00611

				  
		 
				 

		WHEN action = 2 		                                                                                                       	#@G00617
			# confirm update		                                                                                                      	#@G00618
			CALL set_table_record_W120_location(2,l_rec_frm_WZ5.*)		                                                                     	#@G00619
			RETURNING l_rec_tbl_WZ5.*		                                                                                                  	#@G00620
			
			# Perform the prepared update statement		                                                                               	#@G00622
			LET sql_stmt_status = sql_Edit_location(pky.*,l_rec_tbl_WZ5.*) 		                                                            	#@G00623
			CASE 		                                                                                                                 	#@G00624
			WHEN sql_stmt_status = 0		                                                                                              	#@G00625
				MESSAGE "Edit location Successful operation"		                                                                         	#@G00626
				EXECUTE IMMEDIATE "SET ISOLATION TO COMMITTED READ"		                                                                      	#@G00627
				COMMIT WORK		                                                                                                              	#@G00628
						                                                                                                                         	#@G00628
			WHEN sql_stmt_status < 0		                                                                                              	#@G00629
				CALL display_db_error("Edit location:failed ")		                                                                          	#@G00630
				EXECUTE IMMEDIATE "SET ISOLATION TO COMMITTED READ"		                                                                      	#@G00631
				ROLLBACK WORK		                                                                                                            	#@G00632
						                                                                                                                         	#@G00632
			END CASE		                                                                                                              	#@G00633
			EXIT WHILE		                                                                                                            	#@G00634
		END CASE		                                                                                                               	#@G00635
	END WHILE		                                                                                                               	#@G00636
	RETURN sql_stmt_status		                                                                                                  	#@G00637
END FUNCTION ## frm_Edit_WZ5(pky)		                                                                                       	#@G00638


#######################################################################		                                                  	#@G00641
# DELETE A location row		                                                                                                  	#@G00642
# inbound: table primary key		                                                                                             	#@G00643
FUNCTION frm_Delete_WZ5(pky)		                                                                                            	#@G00644
	DEFINE action SMALLINT		                                                                                                  	#@G00645
	DEFINE dummy SMALLINT		                                                                                                   	#@G00646
	DEFINE sql_stmt_status SMALLINT		                                                                                         	#@G00647
	DEFINE pky RECORD 		                                                                                                      	#@G00648
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00648
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00649
	END RECORD		                                                                                                              	#@G00650

	WHILE TRUE		                                                                                                              	#@G00652
		CALL confirm_operation(5,10,"Delete") RETURNING action		                                                                 	#@G00653
		BEGIN WORK		                                                                                                               	#@G00654
		EXECUTE IMMEDIATE "SET ISOLATION TO COMMITTED READ RETAIN UPDATE LOCKS"		                                                  	#@G00655
		WHENEVER ERROR CONTINUE		                                                                                                  	#@G00656
		OPEN crs_upd_location USING pky.*		                                                                                        	#@G00656
		FETCH crs_upd_location INTO dummy		                                                                                        	#@G00656
		IF sqlca.sqlcode = -244 THEN ERROR "THIS ROW IS BEING MODIFIED"
			ROLLBACK WORK EXIT WHILE END IF		                       	#@G00660
		WHENEVER ERROR STOP		                                                                                                      	#@G00661
				                                                                                                                         	#@G00661
		CASE 		                                                                                                                  	#@G00662
		WHEN action = 0 OR action = 1 		                                                                                         	#@G00663
			# can the delete operation		                                                                                            	#@G00664
			EXIT WHILE 		                                                                                                           	#@G00665
		WHEN action = 2		                                                                                                        	#@G00666
			# Validate the delete operation		                                                                                       	#@G00667
			CALL sql_Delete_location(pky.*) RETURNING sql_stmt_status		                                                             	#@G00668
			CASE 		                                                                                                                 	#@G00669
			WHEN sql_stmt_status = 0		                                                                                              	#@G00670
				MESSAGE "Delete location Successful operation"		                                                                       	#@G00671
				COMMIT WORK		                                                                                                              	#@G00672
						                                                                                                                         	#@G00672

											 
															
																											   
																											   
														 
																												 
			
			WHEN sql_stmt_status < 0		                                                                                              	#@G00681
				CALL display_db_error("Delete location:failed ")		                                                                        	#@G00682
				ROLLBACK WORK		                                                                                                            	#@G00683
						                                                                                                                         	#@G00683
			END CASE		                                                                                                              	#@G00684
			EXIT WHILE		                                                                                                            	#@G00685
		END CASE		                                                                                                               	#@G00686
	END WHILE		                                                                                                               	#@G00687
	RETURN sql_stmt_status		                                                                                                  	#@G00688
END FUNCTION ## frm_Delete_WZ5(pky)		                                                                                     	#@G00689

#########################################################################		                                                	#@G00691
#  Build, prepare, declare and initialize main queries and cursors		                                                       	#@G00692
FUNCTION sql_prepare_queries_WZ5_location ()		                                                                            	#@G00693
	DEFINE query_text STRING		                                                                                                	#@G00694

	# PREPARE cursor for full master table row contents, access by primary key		                                              	#@G00696
	LET query_text=		                                                                                                         	#@G00697
	"SELECT 	cmpy_code,locn_code,desc_text,addr1_text,addr2_text,city_text,state_code,post_code,country_code,contact_text,tele_text,fax_text,ware_code,price_high_per,price_low_per,cart_high_per,cart_low_per,other_high_per,other_low_per,price_auth_ind,pallet_charge_ind,bank_code,days_to_del,ol_hold_code,tt_hold_code,oltt_hold_code,excess_day_num,excess_limit_per,price_round_ind,disp_locn_ind,stocktake_ind,def_labour_class,desc2_text,comp_date,approval_flag,summ_cfwd_flag,edit_km_flag,min_cartage_ind,head_info_flag,def_int_cust	",		                                                                                                                       	#@G00698
	" FROM location ",		                                                                                                      	#@G00699
	"WHERE  cmpy_code = ?
    AND locn_code = ?	"		                                                                                                                        	#@G00701

	PREPARE sel_mrw_location FROM query_text		                                                                                	#@G00703
	DECLARE crs_row_location CURSOR FOR sel_mrw_location		                                                                    	#@G00704

	# PREPARE cursor for row test / check if locked		                                                                         	#@G00706
	let query_text= "SELECT 	cmpy_code,locn_code	",		                                                                                                                       	#@G00707
	" FROM location ",		                                                                                                      	#@G00708
	" WHERE  cmpy_code = ?
    AND locn_code = ?	"		                                                                                                                        	#@G00710

	PREPARE sel_pky_location FROM query_text		                                                                                	#@G00712
	DECLARE crs_pky_location CURSOR FOR sel_pky_location		                                                                    	#@G00713
	
	# PREPARE cursor for SELECT FOR UPDATE		                                                                                  	#@G00715
	let query_text= "SELECT 	cmpy_code,locn_code	",		                                                                                                                       	#@G00716
	" FROM location ",		                                                                                                      	#@G00717
	" WHERE  cmpy_code = ?
    AND locn_code = ?	",		                                                                                                                       	#@G00719
	" FOR UPDATE"		                                                                                                           	#@G00720

	PREPARE sel_upd_location FROM query_text		                                                                                	#@G00722
	DECLARE crs_upd_location CURSOR FOR sel_upd_location		                                                                    	#@G00723

	# PREPARE INSERT statement		                                                                                              	#@G00725
	LET query_text =		                                                                                                        	#@G00726
	"INSERT INTO location (	cmpy_code,locn_code,desc_text,addr1_text,addr2_text,city_text,state_code,post_code,country_code,contact_text,tele_text,fax_text,ware_code,price_high_per,price_low_per,cart_high_per,cart_low_per,other_high_per,other_low_per,price_auth_ind,pallet_charge_ind,bank_code,days_to_del,ol_hold_code,tt_hold_code,oltt_hold_code,excess_day_num,excess_limit_per,price_round_ind,disp_locn_ind,stocktake_ind,def_labour_class,desc2_text,comp_date,approval_flag,summ_cfwd_flag,edit_km_flag,min_cartage_ind,head_info_flag,def_int_cust	)",		                                                                                                                      	#@G00727
	" VALUES ( 	?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?	)" 		                                                                                                                      	#@G00728
	PREPARE pr_ins_location FROM query_text		                                                                                 	#@G00729

	# PREPARE UPDATE statement		                                                                                              	#@G00731
	let query_text=		                                                                                                         	#@G00732
	"UPDATE location ",		                                                                                                     	#@G00733
	"SET ( 	desc_text,addr1_text,addr2_text,city_text,state_code,post_code,country_code,contact_text,tele_text,fax_text,ware_code,price_high_per,price_low_per,cart_high_per,cart_low_per,other_high_per,other_low_per,price_auth_ind,pallet_charge_ind,bank_code,days_to_del,ol_hold_code,tt_hold_code,oltt_hold_code,excess_day_num,excess_limit_per,price_round_ind,disp_locn_ind,stocktake_ind,def_labour_class,desc2_text,comp_date,approval_flag,summ_cfwd_flag,edit_km_flag,min_cartage_ind,head_info_flag,def_int_cust	)",		                                                                                                                      	#@G00734
	" = ( 	?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?	)",		                                                                                                                      	#@G00735
	" WHERE  cmpy_code = ?
    AND locn_code = ?	" 		                                                                                                                       	#@G00737
	PREPARE pr_upd_location FROM query_text		                                                                                 	#@G00738

	# PREPARE DELETE statement		                                                                                              	#@G00740
	let query_text= "DELETE FROM location ",		                                                                                	#@G00741
	" WHERE  cmpy_code = ?
    AND locn_code = ?	" 		                                                                                                                       	#@G00743

	PREPARE pr_del_location FROM query_text		                                                                                 	#@G00745

END FUNCTION ## sql_prepare_queries_WZ5_location		                                                                        	#@G00747


#########################################################		                                                                	#@G00750
# Open the QBE cursor,		                                                                                                   	#@G00751
# counts returned rows_count,		                                                                                            	#@G00752
# OPEN the data set,		                                                                                                     	#@G00753
# FETCH first row		                                                                                                        	#@G00754
# inbound parameter: query predicate		                                                                                     	#@G00755
# outbound parameters: number of rows retried		                                                                            	#@G00756
FUNCTION sql_get_qbe_count_location(qry_stmt)		                                                                            	#@G00757
	DEFINE qry_stmt STRING		                                                                                                  	#@G00758
	DEFINE rec_location STRING		                                                                                              	#@G00759
	DEFINE rows_count integer		                                                                                               	#@G00760
	DEFINE lsql_stmt_status integer		                                                                                         	#@G00761

	# define primary_key record		                                                                                             	#@G00763
	DEFINE l_pky RECORD 		                                                                                                    	#@G00764
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00764
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00765
	END RECORD		                                                                                                              	#@G00766

	LET rec_location = 		                                                                                                     	#@G00768
		"SELECT count(*) FROM location",		                                                                                       	#@G00769
		" WHERE ",qry_stmt CLIPPED		                                                                                             	#@G00770

#HUHO
		# Depending on if this program/module was called with or without argument <COMPANY_CODE= XXX> we use the company id of the current user OR the argument cmpy_code
	IF modu_cmpy_code IS NOT NULL THEN
#	
#		LET rec_location = rec_location CLIPPED, " AND cmpy_code = '", trim(glob_rec_kandoouser.cmpy_code), "' "
#	ELSE
		LET rec_location = rec_location CLIPPED, " AND cmpy_code = '", trim(modu_cmpy_code), "' "	
	END IF

#Huho
	
##############
		

	PREPARE prp_cnt_location FROM rec_location		                                                                              	#@G00773
	DECLARE crs_cnt_location CURSOR for prp_cnt_location		                                                                    	#@G00774

	OPEN crs_cnt_location		                                                                                                   	#@G00776
	SET ISOLATION TO DIRTY READ		                                                                                             	#@G00777
	WHENEVER ERROR CONTINUE		                                                                                                 	#@G00778
	FETCH crs_cnt_location INTO rows_count		                                                                                  	#@G00779
	WHENEVER ERROR CALL error_mngmt		                                                                                         	#@G00780
	SET ISOLATION TO COMMITTED READ		                                                                                         	#@G00781

	# if FETCH fails, count = 0, the, get back to query		                                                                     	#@G00783
	IF sqlca.sqlcode OR rows_count = 0 THEN		                                                                                 	#@G00784
		let rows_count =0		                                                                                                      	#@G00785
	END IF		                                                                                                                  	#@G00786
	FREE crs_cnt_location		                                                                                                   	#@G00787
	RETURN rows_count		                                                                                                       	#@G00788
END FUNCTION ## sql_get_qbe_count_location		                                                                               	#@G00789

#########################################################		                                                                	#@G00791
FUNCTION sql_opn_pky_scr_curs_location(qry_stmt)		                                                                         	#@G00792
## Build the query generated by CONSTRUCT BY NAME,		                                                                       	#@G00793
## Declare and OPEN the cursor		                                                                                           	#@G00794
## inbound param: query predicate		                                                                                        	#@G00795
## outbound parameter: query status		                                                                                      	#@G00796
	DEFINE qry_stmt STRING		                                                                                                  	#@G00797
	DEFINE rec_location STRING		                                                                                              	#@G00798
	DEFINE rows_count integer		                                                                                               	#@G00799
	DEFINE lsql_stmt_status integer		                                                                                         	#@G00800

	# define primary_key record		                                                                                             	#@G00802
	DEFINE l_pky RECORD 		                                                                                                    	#@G00803
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00803
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00804
	END RECORD		                                                                                                              	#@G00805

	# display the selected columns		                                                                                          	#@G00807

	LET rec_location = "SELECT cmpy_code,locn_code	",		                                                                                                                       	#@G00809
	" FROM location ",		                                                                                                      	#@G00810
	"WHERE cmpy_code='", modu_cmpy_code CLIPPED, "' AND " ,qry_stmt clipped,		                                                                                              	#@G00811
	" ORDER BY cmpy_code,locn_code "		                                                                                                                        	#@G00812
	
	PREPARE rech_crs_ FROM rec_location		                                                                                     	#@G00814

	# crs_scrl_crs_ : the first cursor selects all the primary keys (not all the table columns)		                             	#@G00816

	DECLARE crs_scrl_crs_ SCROLL CURSOR 	WITH HOLD	 FOR rech_crs_		                                                                                                           	#@G00818

	WHENEVER ERROR CONTINUE		                                                                                                 	#@G00820
	OPEN crs_scrl_crs_		                                                                                                      	#@G00821
	WHENEVER ERROR CALL error_mngmt		                                                                                         	#@G00822

	RETURN sqlca.sqlcode		                                                                                                    	#@G00824
END FUNCTION ## sql_opn_pky_scr_curs_location		                                                                            	#@G00825

#######################################################################		                                                  	#@G00827
FUNCTION sql_nxtprev_location(offset)		                                                                                    	#@G00828
## sql_nxtprev_location : FETCH NEXT OR PREVIOUS RECORD		                                                                  	#@G00829
	DEFINE offset SMALLINT		                                                                                                  	#@G00830
	define lsql_stmt_status,record_found integer		                                                                            	#@G00831
	DEFINE pky RECORD 		                                                                                                      	#@G00832
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00832
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00833
	END RECORD		                                                                                                              	#@G00834
	DEFINE l_rec_frm_WZ5 RECORD 		                                                                                                 	#@G00835
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G00835
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G00835
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G00835
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G00835
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G00835
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G00835
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G00835
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G00835
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G00835
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G00835
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G00835
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G00835
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G00835
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G00835
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G00835
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G00835
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G00835
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G00835
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G00835
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G00835
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G00835
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G00835
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G00835
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G00835
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G00835
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G00835
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G00835
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G00835
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G00835
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G00835
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G00835
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G00835
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G00835
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G00835
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G00835
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G00835
		comp_date LIKE location.comp_date #  date		                                                                                	#@G00835
				                                                                                                                         	#@G00836
	END RECORD		                                                                                                              	#@G00837

WHENEVER ERROR CONTINUE		                                                                                                  	#@G00839
	FETCH RELATIVE offset crs_scrl_crs_ INTO pky.*		                                                                          	#@G00840
WHENEVER ERROR CALL error_mngmt		                                                                                          	#@G00841

	CASE 		                                                                                                                   	#@G00843
	WHEN sqlca.sqlcode = 100 		                                                                                               	#@G00844
		LET record_found = 0		                                                                                                   	#@G00845
		
	WHEN sqlca.sqlcode < 0 		                                                                                                 	#@G00847
		LET record_found = -1		                                                                                                  	#@G00848
	OTHERWISE		                                                                                                               	#@G00849
		LET lsql_stmt_status = 1		                                                                                               	#@G00850
		LET record_found = 1		                                                                                                   	#@G00851
		#CALL sql_FETCH_full_row_location (pky.*)		                                                                              	#@G00852
		#RETURNING record_found,l_rec_frm_WZ5.*		                                                                                     	#@G00853
		
	END CASE		                                                                                                                	#@G00855
	RETURN record_found,pky.*		                                                                                               	#@G00856
END FUNCTION ## sql_nxtprev_location		                                                                                     	#@G00857

#########################################################################################		                                	#@G00859
FUNCTION sql_FETCH_full_row_location(pky_location)		                                                                       	#@G00860
# sql_FETCH_full_row_location : read a complete row accessing by primary key		                                             	#@G00861
# inbound parameter : primary key		                                                                                        	#@G00862
# outbound parameter: sql_stmt_status and row contents		                                                                   	#@G00863
	DEFINE sql_stmt_status smallint		                                                                                         	#@G00864
	DEFINE pky_location RECORD 		                                                                                             	#@G00865
	cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00865
	locn_code LIKE location.locn_code # nchar(3)			                                                                                                                         	#@G00866
	END RECORD		                                                                                                              	#@G00867
	DEFINE l_rec_tbl_WZ5 RECORD 		                                                                                                 	#@G00868
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00868
		locn_code LIKE location.locn_code, # nchar(3)		                                                                            	#@G00868
		desc_text LIKE location.desc_text, # nvarchar(40)		                                                                        	#@G00868
		addr1_text LIKE location.addr1_text, # nvarchar(40)		                                                                      	#@G00868
		addr2_text LIKE location.addr2_text, # nvarchar(40)		                                                                      	#@G00868
		city_text LIKE location.city_text, # nvarchar(40)		                                                                        	#@G00868
		state_code LIKE location.state_code, # nvarchar(6)		                                                                       	#@G00868
		post_code LIKE location.post_code, # nvarchar(10)		                                                                        	#@G00868
		country_code LIKE location.country_code, # nchar(3)		                                                                      	#@G00868
		contact_text LIKE location.contact_text, # nvarchar(40)		                                                                  	#@G00868
		tele_text LIKE location.tele_text, # nvarchar(20)		                                                                        	#@G00868
		fax_text LIKE location.fax_text, # nvarchar(20)		                                                                          	#@G00868
		ware_code LIKE location.ware_code, # nchar(3)		                                                                            	#@G00868
		price_high_per LIKE location.price_high_per, # DECIMAL		                                                                   	#@G00868
		price_low_per LIKE location.price_low_per, # DECIMAL		                                                                     	#@G00868
		cart_high_per LIKE location.cart_high_per, # DECIMAL		                                                                     	#@G00868
		cart_low_per LIKE location.cart_low_per, # DECIMAL		                                                                       	#@G00868
		other_high_per LIKE location.other_high_per, # DECIMAL		                                                                   	#@G00868
		other_low_per LIKE location.other_low_per, # DECIMAL		                                                                     	#@G00868
		price_auth_ind LIKE location.price_auth_ind, # nchar(1)		                                                                  	#@G00868
		pallet_charge_ind LIKE location.pallet_charge_ind, # nchar(1)		                                                            	#@G00868
		bank_code LIKE location.bank_code, # nvarchar(9)		                                                                         	#@G00868
		days_to_del LIKE location.days_to_del, # smallint		                                                                        	#@G00868
		ol_hold_code LIKE location.ol_hold_code, # nchar(3)		                                                                      	#@G00868
		tt_hold_code LIKE location.tt_hold_code, # nchar(3)		                                                                      	#@G00868
		oltt_hold_code LIKE location.oltt_hold_code, # nchar(3)		                                                                  	#@G00868
		excess_day_num LIKE location.excess_day_num, # smallint		                                                                  	#@G00868
		excess_limit_per LIKE location.excess_limit_per, # smallint		                                                              	#@G00868
		price_round_ind LIKE location.price_round_ind, # nchar(1)		                                                                	#@G00868
		disp_locn_ind LIKE location.disp_locn_ind, # nchar(1)		                                                                    	#@G00868
		stocktake_ind LIKE location.stocktake_ind, # nchar(1)		                                                                    	#@G00868
		def_labour_class LIKE location.def_labour_class, # nvarchar(8)		                                                           	#@G00868
		desc2_text LIKE location.desc2_text, # nvarchar(60)		                                                                      	#@G00868
		comp_date LIKE location.comp_date, # date		                                                                                	#@G00868
		approval_flag LIKE location.approval_flag, # nchar(1)		                                                                    	#@G00868
		summ_cfwd_flag LIKE location.summ_cfwd_flag, # nchar(1)		                                                                  	#@G00868
		edit_km_flag LIKE location.edit_km_flag, # nchar(1)		                                                                      	#@G00868
		min_cartage_ind LIKE location.min_cartage_ind, # nchar(1)		                                                                	#@G00868
		head_info_flag LIKE location.head_info_flag, # nchar(1)		                                                                  	#@G00868
		def_int_cust LIKE location.def_int_cust # nvarchar(8)				                                                                                                                         	#@G00869
	END RECORD		                                                                                                              	#@G00870
	DEFINE l_rec_frm_WZ5 RECORD 		                                                                                                 	#@G00871
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G00871
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G00871
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G00871
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G00871
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G00871
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G00871
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G00871
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G00871
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G00871
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G00871
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G00871
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G00871
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G00871
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G00871
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G00871
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G00871
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G00871
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G00871
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G00871
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G00871
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G00871
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G00871
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G00871
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G00871
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G00871
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G00871
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G00871
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G00871
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G00871
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G00871
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G00871
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G00871
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G00871
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G00871
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G00871
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G00871
		comp_date LIKE location.comp_date #  date		                                                                                	#@G00871
				                                                                                                                         	#@G00872
	END RECORD		                                                                                                              	#@G00873

	DEFINE lookup_status INTEGER		                                                                                             	#@G00875
	DEFINE lku_bank RECORD		                                                                                                   	#@G00875
		name_acct_text LIKE bank.name_acct_text #  nvarchar(40)		                                                                  	#@G00875
	
	END RECORD		                                                                                                             	#@G00876
	DEFINE lku_warehouse RECORD		                                                                                              	#@G00876
		desc_text LIKE warehouse.desc_text #  nvarchar(30)		                                                                       	#@G00876
	
	END RECORD		                                                                                                             	#@G00877
			                                                                                                                         	#@G00877

	# read the table, access on primary key		                                                                                 	#@G00879
WHENEVER ERROR CONTINUE		                                                                                                  	#@G00880
	OPEN crs_row_location 		                                                                                                  	#@G00881
	USING pky_location.*		                                                                                                    	#@G00882

	FETCH crs_row_location INTO l_rec_tbl_WZ5.*		                                                                                  	#@G00884

WHENEVER ERROR CALL error_mngmt		                                                                                          	#@G00886
	CASE		                                                                                                                    	#@G00887
	WHEN sqlca.sqlcode = 100 		                                                                                               	#@G00888
		LET sql_stmt_status = 0		                                                                                                	#@G00889
	WHEN sqlca.sqlcode < 0 		                                                                                                 	#@G00890
		LET sql_stmt_status = -1		                                                                                               	#@G00891
	OTHERWISE		                                                                                                               	#@G00892
		LET sql_stmt_status = 1		                                                                                                	#@G00893
		CALL set_form_record_WZ5(l_rec_tbl_WZ5.*)		                                                                                  	#@G00894
		RETURNING l_rec_frm_WZ5.*		                                                                                                   	#@G00895
										  
											   
		  
	END CASE		                                                                                                                	#@G00899
	RETURN sql_stmt_status,l_rec_frm_WZ5.*		                                                                                       	#@G00900
END FUNCTION ## sql_FETCH_full_row_location		                                                                              	#@G00901

########################################################################		                                                 	#@G00903
FUNCTION sql_Insert_location(l_rec_tbl_WZ5)		                                                                                   	#@G00904
## INSERT in table location 		                                                                                             	#@G00905
	DEFINE lsql_stmt_status integer		                                                                                         	#@G00906
	DEFINE rows_count SMALLINT		                                                                                              	#@G00907
	DEFINE pky RECORD		                                                                                                       	#@G00908
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00908
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00909
	END RECORD		                                                                                                              	#@G00910
	DEFINE l_rec_tbl_WZ5 RECORD 		                                                                                                 	#@G00911
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00911
		locn_code LIKE location.locn_code, # nchar(3)		                                                                            	#@G00911
		desc_text LIKE location.desc_text, # nvarchar(40)		                                                                        	#@G00911
		addr1_text LIKE location.addr1_text, # nvarchar(40)		                                                                      	#@G00911
		addr2_text LIKE location.addr2_text, # nvarchar(40)		                                                                      	#@G00911
		city_text LIKE location.city_text, # nvarchar(40)		                                                                        	#@G00911
		state_code LIKE location.state_code, # nvarchar(6)		                                                                       	#@G00911
		post_code LIKE location.post_code, # nvarchar(10)		                                                                        	#@G00911
		country_code LIKE location.country_code, # nchar(3)		                                                                      	#@G00911
		contact_text LIKE location.contact_text, # nvarchar(40)		                                                                  	#@G00911
		tele_text LIKE location.tele_text, # nvarchar(20)		                                                                        	#@G00911
		fax_text LIKE location.fax_text, # nvarchar(20)		                                                                          	#@G00911
		ware_code LIKE location.ware_code, # nchar(3)		                                                                            	#@G00911
		price_high_per LIKE location.price_high_per, # DECIMAL		                                                                   	#@G00911
		price_low_per LIKE location.price_low_per, # DECIMAL		                                                                     	#@G00911
		cart_high_per LIKE location.cart_high_per, # DECIMAL		                                                                     	#@G00911
		cart_low_per LIKE location.cart_low_per, # DECIMAL		                                                                       	#@G00911
		other_high_per LIKE location.other_high_per, # DECIMAL		                                                                   	#@G00911
		other_low_per LIKE location.other_low_per, # DECIMAL		                                                                     	#@G00911
		price_auth_ind LIKE location.price_auth_ind, # nchar(1)		                                                                  	#@G00911
		pallet_charge_ind LIKE location.pallet_charge_ind, # nchar(1)		                                                            	#@G00911
		bank_code LIKE location.bank_code, # nvarchar(9)		                                                                         	#@G00911
		days_to_del LIKE location.days_to_del, # smallint		                                                                        	#@G00911
		ol_hold_code LIKE location.ol_hold_code, # nchar(3)		                                                                      	#@G00911
		tt_hold_code LIKE location.tt_hold_code, # nchar(3)		                                                                      	#@G00911
		oltt_hold_code LIKE location.oltt_hold_code, # nchar(3)		                                                                  	#@G00911
		excess_day_num LIKE location.excess_day_num, # smallint		                                                                  	#@G00911
		excess_limit_per LIKE location.excess_limit_per, # smallint		                                                              	#@G00911
		price_round_ind LIKE location.price_round_ind, # nchar(1)		                                                                	#@G00911
		disp_locn_ind LIKE location.disp_locn_ind, # nchar(1)		                                                                    	#@G00911
		stocktake_ind LIKE location.stocktake_ind, # nchar(1)		                                                                    	#@G00911
		def_labour_class LIKE location.def_labour_class, # nvarchar(8)		                                                           	#@G00911
		desc2_text LIKE location.desc2_text, # nvarchar(60)		                                                                      	#@G00911
		comp_date LIKE location.comp_date, # date		                                                                                	#@G00911
		approval_flag LIKE location.approval_flag, # nchar(1)		                                                                    	#@G00911
		summ_cfwd_flag LIKE location.summ_cfwd_flag, # nchar(1)		                                                                  	#@G00911
		edit_km_flag LIKE location.edit_km_flag, # nchar(1)		                                                                      	#@G00911
		min_cartage_ind LIKE location.min_cartage_ind, # nchar(1)		                                                                	#@G00911
		head_info_flag LIKE location.head_info_flag, # nchar(1)		                                                                  	#@G00911
		def_int_cust LIKE location.def_int_cust # nvarchar(8)				                                                                                                                         	#@G00912
	END RECORD		                                                                                                              	#@G00913
WHENEVER ERROR CONTINUE		                                                                                                  	#@G00914
	EXECUTE pr_ins_location 		                                                                                                	#@G00915
	USING 	l_rec_tbl_WZ5.cmpy_code,		                                                                                                      	#@G00915
	l_rec_tbl_WZ5.locn_code,		                                                                                                      	#@G00915
	l_rec_tbl_WZ5.desc_text,		                                                                                                      	#@G00915
	l_rec_tbl_WZ5.addr1_text,		                                                                                                     	#@G00915
	l_rec_tbl_WZ5.addr2_text,		                                                                                                     	#@G00915
	l_rec_tbl_WZ5.city_text,		                                                                                                      	#@G00915
	l_rec_tbl_WZ5.state_code,		                                                                                                     	#@G00915
	l_rec_tbl_WZ5.post_code,		                                                                                                      	#@G00915
	l_rec_tbl_WZ5.country_code,		                                                                                                   	#@G00915
	l_rec_tbl_WZ5.contact_text,		                                                                                                   	#@G00915
	l_rec_tbl_WZ5.tele_text,		                                                                                                      	#@G00915
	l_rec_tbl_WZ5.fax_text,		                                                                                                       	#@G00915
	l_rec_tbl_WZ5.ware_code,		                                                                                                      	#@G00915
	l_rec_tbl_WZ5.price_high_per,		                                                                                                 	#@G00915
	l_rec_tbl_WZ5.price_low_per,		                                                                                                  	#@G00915
	l_rec_tbl_WZ5.cart_high_per,		                                                                                                  	#@G00915
	l_rec_tbl_WZ5.cart_low_per,		                                                                                                   	#@G00915
	l_rec_tbl_WZ5.other_high_per,		                                                                                                 	#@G00915
	l_rec_tbl_WZ5.other_low_per,		                                                                                                  	#@G00915
	l_rec_tbl_WZ5.price_auth_ind,		                                                                                                 	#@G00915
	l_rec_tbl_WZ5.pallet_charge_ind,		                                                                                              	#@G00915
	l_rec_tbl_WZ5.bank_code,		                                                                                                      	#@G00915
	l_rec_tbl_WZ5.days_to_del,		                                                                                                    	#@G00915
	l_rec_tbl_WZ5.ol_hold_code,		                                                                                                   	#@G00915
	l_rec_tbl_WZ5.tt_hold_code,		                                                                                                   	#@G00915
	l_rec_tbl_WZ5.oltt_hold_code,		                                                                                                 	#@G00915
	l_rec_tbl_WZ5.excess_day_num,		                                                                                                 	#@G00915
	l_rec_tbl_WZ5.excess_limit_per,		                                                                                               	#@G00915
	l_rec_tbl_WZ5.price_round_ind,		                                                                                                	#@G00915
	l_rec_tbl_WZ5.disp_locn_ind,		                                                                                                  	#@G00915
	l_rec_tbl_WZ5.stocktake_ind,		                                                                                                  	#@G00915
	l_rec_tbl_WZ5.def_labour_class,		                                                                                               	#@G00915
	l_rec_tbl_WZ5.desc2_text,		                                                                                                     	#@G00915
	l_rec_tbl_WZ5.comp_date,		                                                                                                      	#@G00915
	l_rec_tbl_WZ5.approval_flag,		                                                                                                  	#@G00915
	l_rec_tbl_WZ5.summ_cfwd_flag,		                                                                                                 	#@G00915
	l_rec_tbl_WZ5.edit_km_flag,		                                                                                                   	#@G00915
	l_rec_tbl_WZ5.min_cartage_ind,		                                                                                                	#@G00915
	l_rec_tbl_WZ5.head_info_flag,		                                                                                                 	#@G00915
	l_rec_tbl_WZ5.def_int_cust			                                                                                                                         	#@G00916
WHENEVER ERROR CALL error_mngmt		                                                                                          	#@G00917

	IF sqlca.sqlcode < 0 THEN 		                                                                                              	#@G00919
		LET lsql_stmt_status = -1		                                                                                              	#@G00920
	ELSE 		                                                                                                                   	#@G00921
		LET lsql_stmt_status = 0		                                                                                               	#@G00922
				                                                                                                                         	#@G00923
		
	END IF		                                                                                                                  	#@G00925
	RETURN lsql_stmt_status,pky.*		                                                                                           	#@G00926
END FUNCTION ## sql_Insert_location		                                                                                      	#@G00927

########################################################################		                                                 	#@G00929
FUNCTION sql_Edit_location(pky,l_rec_tbl_WZ5)		                                                                                 	#@G00930
## sql_Edit_location :update location record		                                                                             	#@G00931
	DEFINE lsql_stmt_status integer		                                                                                         	#@G00932
	DEFINE pky RECORD 		                                                                                                      	#@G00933
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00933
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00934
	END RECORD		                                                                                                              	#@G00935
	DEFINE l_rec_tbl_WZ5 RECORD 		                                                                                                 	#@G00936
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00936
		locn_code LIKE location.locn_code, # nchar(3)		                                                                            	#@G00936
		desc_text LIKE location.desc_text, # nvarchar(40)		                                                                        	#@G00936
		addr1_text LIKE location.addr1_text, # nvarchar(40)		                                                                      	#@G00936
		addr2_text LIKE location.addr2_text, # nvarchar(40)		                                                                      	#@G00936
		city_text LIKE location.city_text, # nvarchar(40)		                                                                        	#@G00936
		state_code LIKE location.state_code, # nvarchar(6)		                                                                       	#@G00936
		post_code LIKE location.post_code, # nvarchar(10)		                                                                        	#@G00936
		country_code LIKE location.country_code, # nchar(3)		                                                                      	#@G00936
		contact_text LIKE location.contact_text, # nvarchar(40)		                                                                  	#@G00936
		tele_text LIKE location.tele_text, # nvarchar(20)		                                                                        	#@G00936
		fax_text LIKE location.fax_text, # nvarchar(20)		                                                                          	#@G00936
		ware_code LIKE location.ware_code, # nchar(3)		                                                                            	#@G00936
		price_high_per LIKE location.price_high_per, # DECIMAL		                                                                   	#@G00936
		price_low_per LIKE location.price_low_per, # DECIMAL		                                                                     	#@G00936
		cart_high_per LIKE location.cart_high_per, # DECIMAL		                                                                     	#@G00936
		cart_low_per LIKE location.cart_low_per, # DECIMAL		                                                                       	#@G00936
		other_high_per LIKE location.other_high_per, # DECIMAL		                                                                   	#@G00936
		other_low_per LIKE location.other_low_per, # DECIMAL		                                                                     	#@G00936
		price_auth_ind LIKE location.price_auth_ind, # nchar(1)		                                                                  	#@G00936
		pallet_charge_ind LIKE location.pallet_charge_ind, # nchar(1)		                                                            	#@G00936
		bank_code LIKE location.bank_code, # nvarchar(9)		                                                                         	#@G00936
		days_to_del LIKE location.days_to_del, # smallint		                                                                        	#@G00936
		ol_hold_code LIKE location.ol_hold_code, # nchar(3)		                                                                      	#@G00936
		tt_hold_code LIKE location.tt_hold_code, # nchar(3)		                                                                      	#@G00936
		oltt_hold_code LIKE location.oltt_hold_code, # nchar(3)		                                                                  	#@G00936
		excess_day_num LIKE location.excess_day_num, # smallint		                                                                  	#@G00936
		excess_limit_per LIKE location.excess_limit_per, # smallint		                                                              	#@G00936
		price_round_ind LIKE location.price_round_ind, # nchar(1)		                                                                	#@G00936
		disp_locn_ind LIKE location.disp_locn_ind, # nchar(1)		                                                                    	#@G00936
		stocktake_ind LIKE location.stocktake_ind, # nchar(1)		                                                                    	#@G00936
		def_labour_class LIKE location.def_labour_class, # nvarchar(8)		                                                           	#@G00936
		desc2_text LIKE location.desc2_text, # nvarchar(60)		                                                                      	#@G00936
		comp_date LIKE location.comp_date, # date		                                                                                	#@G00936
		approval_flag LIKE location.approval_flag, # nchar(1)		                                                                    	#@G00936
		summ_cfwd_flag LIKE location.summ_cfwd_flag, # nchar(1)		                                                                  	#@G00936
		edit_km_flag LIKE location.edit_km_flag, # nchar(1)		                                                                      	#@G00936
		min_cartage_ind LIKE location.min_cartage_ind, # nchar(1)		                                                                	#@G00936
		head_info_flag LIKE location.head_info_flag, # nchar(1)		                                                                  	#@G00936
		def_int_cust LIKE location.def_int_cust # nvarchar(8)				                                                                                                                         	#@G00937
	END RECORD		                                                                                                              	#@G00938

WHENEVER ERROR CONTINUE		                                                                                                  	#@G00940
	EXECUTE pr_upd_location 		                                                                                                	#@G00941
	USING 	l_rec_tbl_WZ5.desc_text,		                                                                                                      	#@G00941
	l_rec_tbl_WZ5.addr1_text,		                                                                                                     	#@G00941
	l_rec_tbl_WZ5.addr2_text,		                                                                                                     	#@G00941
	l_rec_tbl_WZ5.city_text,		                                                                                                      	#@G00941
	l_rec_tbl_WZ5.state_code,		                                                                                                     	#@G00941
	l_rec_tbl_WZ5.post_code,		                                                                                                      	#@G00941
	l_rec_tbl_WZ5.country_code,		                                                                                                   	#@G00941
	l_rec_tbl_WZ5.contact_text,		                                                                                                   	#@G00941
	l_rec_tbl_WZ5.tele_text,		                                                                                                      	#@G00941
	l_rec_tbl_WZ5.fax_text,		                                                                                                       	#@G00941
	l_rec_tbl_WZ5.ware_code,		                                                                                                      	#@G00941
	l_rec_tbl_WZ5.price_high_per,		                                                                                                 	#@G00941
	l_rec_tbl_WZ5.price_low_per,		                                                                                                  	#@G00941
	l_rec_tbl_WZ5.cart_high_per,		                                                                                                  	#@G00941
	l_rec_tbl_WZ5.cart_low_per,		                                                                                                   	#@G00941
	l_rec_tbl_WZ5.other_high_per,		                                                                                                 	#@G00941
	l_rec_tbl_WZ5.other_low_per,		                                                                                                  	#@G00941
	l_rec_tbl_WZ5.price_auth_ind,		                                                                                                 	#@G00941
	l_rec_tbl_WZ5.pallet_charge_ind,		                                                                                              	#@G00941
	l_rec_tbl_WZ5.bank_code,		                                                                                                      	#@G00941
	l_rec_tbl_WZ5.days_to_del,		                                                                                                    	#@G00941
	l_rec_tbl_WZ5.ol_hold_code,		                                                                                                   	#@G00941
	l_rec_tbl_WZ5.tt_hold_code,		                                                                                                   	#@G00941
	l_rec_tbl_WZ5.oltt_hold_code,		                                                                                                 	#@G00941
	l_rec_tbl_WZ5.excess_day_num,		                                                                                                 	#@G00941
	l_rec_tbl_WZ5.excess_limit_per,		                                                                                               	#@G00941
	l_rec_tbl_WZ5.price_round_ind,		                                                                                                	#@G00941
	l_rec_tbl_WZ5.disp_locn_ind,		                                                                                                  	#@G00941
	l_rec_tbl_WZ5.stocktake_ind,		                                                                                                  	#@G00941
	l_rec_tbl_WZ5.def_labour_class,		                                                                                               	#@G00941
	l_rec_tbl_WZ5.desc2_text,		                                                                                                     	#@G00941
	l_rec_tbl_WZ5.comp_date,		                                                                                                      	#@G00941
	l_rec_tbl_WZ5.approval_flag,		                                                                                                  	#@G00941
	l_rec_tbl_WZ5.summ_cfwd_flag,		                                                                                                 	#@G00941
	l_rec_tbl_WZ5.edit_km_flag,		                                                                                                   	#@G00941
	l_rec_tbl_WZ5.min_cartage_ind,		                                                                                                	#@G00941
	l_rec_tbl_WZ5.head_info_flag,		                                                                                                 	#@G00941
	l_rec_tbl_WZ5.def_int_cust	,		                                                                                                                        	#@G00942
	pky.*		                                                                                                                   	#@G00943

WHENEVER ERROR CALL error_mngmt		                                                                                          	#@G00945
	IF sqlca.sqlcode < 0 THEN 		                                                                                              	#@G00946
		
		LET lsql_stmt_status = -1		                                                                                              	#@G00948
	ELSE 		                                                                                                                   	#@G00949
		LET lsql_stmt_status = 0		                                                                                               	#@G00950
	END IF		                                                                                                                  	#@G00951
	RETURN lsql_stmt_status		                                                                                                 	#@G00952
END FUNCTION ## sql_Edit_location		                                                                                        	#@G00953

##############################################################################################		                           	#@G00955
FUNCTION sql_Delete_location(l_rec_pky)		                                                                                        	#@G00956
## sql_Delete_location :delete current row in table location 		                                                            	#@G00957
	DEFINE lsql_stmt_status smallint		                                                                                        	#@G00958
	DEFINE l_rec_pky 
		RECORD 		                                                                                                      	#@G00959
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00959
		locn_code LIKE location.locn_code # nchar(3)			                                                                                                                         	#@G00960
		END RECORD		                                                                                                               	#@G00961

WHENEVER ERROR CONTINUE		                                                                                                  	#@G00963
   EXECUTE pr_del_location 		                                                                                              	#@G00964
   USING l_rec_pky.*		                                                                                                           	#@G00965

WHENEVER ERROR CALL error_mngmt		                                                                                          	#@G00967
	IF sqlca.sqlcode < 0 THEN 		                                                                                              	#@G00968
		LET lsql_stmt_status = -1		                                                                                              	#@G00969
	ELSE		                                                                                                                    	#@G00970
		LET lsql_stmt_status=0		                                                                                                 	#@G00971
	END IF		                                                                                                                  	#@G00972
	RETURN lsql_stmt_status		                                                                                                 	#@G00973
END FUNCTION ## sql_Delete_location		                                                                                      	#@G00974

################################################################################		                                         	#@G00976
FUNCTION sql_status_pk_location(pky)  		                                                                                   	#@G00977
##   sql_status_pk_location : Check if primary key exists		                                                                	#@G00978
## inbound parameter : record of primary key		                                                                             	#@G00979
## outbound parameter:  status > 0 if exists, 0 if no record, < 0 if error		                                               	#@G00980
	DEFINE pky RECORD 		                                                                                                      	#@G00981
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G00981
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G00982
	END RECORD		                                                                                                              	#@G00983
	DEFINE pk_status INTEGER		                                                                                                	#@G00984

WHENEVER ERROR CONTINUE		                                                                                                  	#@G00986
	OPEN crs_pky_location USING pky.*		                                                                                       	#@G00987
	FETCH crs_pky_location 		                                                                                                 	#@G00988
WHENEVER ERROR CALL error_mngmt		                                                                                          	#@G00989

	CASE sqlca.sqlcode		                                                                                                      	#@G00991
	WHEN 0 		                                                                                                                 	#@G00992
		let pk_status = 1		                                                                                                      	#@G00993
	WHEN 100		                                                                                                                	#@G00994
		let pk_status = 0		                                                                                                      	#@G00995
	WHEN sqlca.sqlerrd[2] = 104		                                                                                             	#@G00996
		let pk_status = -1 # record locked		                                                                                     	#@G00997
	WHEN sqlca.sqlcode < 0		                                                                                                  	#@G00998
		let pk_status = sqlca.sqlcode		                                                                                          	#@G00999
	END CASE		                                                                                                                	#@G01000

	RETURN pk_status		                                                                                                        	#@G01002
END FUNCTION ## sql_status_pk_location		                                                                                   	#@G01003

################################################################################################		                         	#@G01005
FUNCTION set_form_record_WZ5(tbl_contents)		                                                                              	#@G01006
## set_form_record_WZ5_W120: assigns table values to form fields values		                                                 	#@G01007
	DEFINE frm_contents RECORD		                                                                                              	#@G01008
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G01008
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G01008
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G01008
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G01008
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G01008
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G01008
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G01008
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G01008
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G01008
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G01008
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G01008
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G01008
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G01008
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G01008
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G01008
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G01008
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G01008
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G01008
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G01008
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G01008
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G01008
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G01008
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G01008
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G01008
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G01008
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G01008
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G01008
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G01008
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G01008
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G01008
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G01008
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G01008
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G01008
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G01008
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G01008
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G01008
		comp_date LIKE location.comp_date #  date		                                                                                	#@G01008
				                                                                                                                         	#@G01009
	END RECORD		                                                                                                              	#@G01010

	DEFINE tbl_contents RECORD		                                                                                              	#@G01012
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G01012
		locn_code LIKE location.locn_code, # nchar(3)		                                                                            	#@G01012
		desc_text LIKE location.desc_text, # nvarchar(40)		                                                                        	#@G01012
		addr1_text LIKE location.addr1_text, # nvarchar(40)		                                                                      	#@G01012
		addr2_text LIKE location.addr2_text, # nvarchar(40)		                                                                      	#@G01012
		city_text LIKE location.city_text, # nvarchar(40)		                                                                        	#@G01012
		state_code LIKE location.state_code, # nvarchar(6)		                                                                       	#@G01012
		post_code LIKE location.post_code, # nvarchar(10)		                                                                        	#@G01012
		country_code LIKE location.country_code, # nchar(3)		                                                                      	#@G01012
		contact_text LIKE location.contact_text, # nvarchar(40)		                                                                  	#@G01012
		tele_text LIKE location.tele_text, # nvarchar(20)		                                                                        	#@G01012
		fax_text LIKE location.fax_text, # nvarchar(20)		                                                                          	#@G01012
		ware_code LIKE location.ware_code, # nchar(3)		                                                                            	#@G01012
		price_high_per LIKE location.price_high_per, # DECIMAL		                                                                   	#@G01012
		price_low_per LIKE location.price_low_per, # DECIMAL		                                                                     	#@G01012
		cart_high_per LIKE location.cart_high_per, # DECIMAL		                                                                     	#@G01012
		cart_low_per LIKE location.cart_low_per, # DECIMAL		                                                                       	#@G01012
		other_high_per LIKE location.other_high_per, # DECIMAL		                                                                   	#@G01012
		other_low_per LIKE location.other_low_per, # DECIMAL		                                                                     	#@G01012
		price_auth_ind LIKE location.price_auth_ind, # nchar(1)		                                                                  	#@G01012
		pallet_charge_ind LIKE location.pallet_charge_ind, # nchar(1)		                                                            	#@G01012
		bank_code LIKE location.bank_code, # nvarchar(9)		                                                                         	#@G01012
		days_to_del LIKE location.days_to_del, # smallint		                                                                        	#@G01012
		ol_hold_code LIKE location.ol_hold_code, # nchar(3)		                                                                      	#@G01012
		tt_hold_code LIKE location.tt_hold_code, # nchar(3)		                                                                      	#@G01012
		oltt_hold_code LIKE location.oltt_hold_code, # nchar(3)		                                                                  	#@G01012
		excess_day_num LIKE location.excess_day_num, # smallint		                                                                  	#@G01012
		excess_limit_per LIKE location.excess_limit_per, # smallint		                                                              	#@G01012
		price_round_ind LIKE location.price_round_ind, # nchar(1)		                                                                	#@G01012
		disp_locn_ind LIKE location.disp_locn_ind, # nchar(1)		                                                                    	#@G01012
		stocktake_ind LIKE location.stocktake_ind, # nchar(1)		                                                                    	#@G01012
		def_labour_class LIKE location.def_labour_class, # nvarchar(8)		                                                           	#@G01012
		desc2_text LIKE location.desc2_text, # nvarchar(60)		                                                                      	#@G01012
		comp_date LIKE location.comp_date, # date		                                                                                	#@G01012
		approval_flag LIKE location.approval_flag, # nchar(1)		                                                                    	#@G01012
		summ_cfwd_flag LIKE location.summ_cfwd_flag, # nchar(1)		                                                                  	#@G01012
		edit_km_flag LIKE location.edit_km_flag, # nchar(1)		                                                                      	#@G01012
		min_cartage_ind LIKE location.min_cartage_ind, # nchar(1)		                                                                	#@G01012
		head_info_flag LIKE location.head_info_flag, # nchar(1)		                                                                  	#@G01012
		def_int_cust LIKE location.def_int_cust # nvarchar(8)				                                                                                                                         	#@G01013
	END RECORD		                                                                                                              	#@G01014

	INITIALIZE frm_contents.* TO NULL		                                                                                       	#@G01016
	LET frm_contents.cmpy_code = tbl_contents.cmpy_code		                                                                      	#@G01017
	LET frm_contents.locn_code = tbl_contents.locn_code		                                                                      	#@G01018
	LET frm_contents.desc_text = tbl_contents.desc_text		                                                                      	#@G01019
	LET frm_contents.addr1_text = tbl_contents.addr1_text		                                                                    	#@G01020
	LET frm_contents.ware_code = tbl_contents.ware_code		                                                                      	#@G01021
	LET frm_contents.addr2_text = tbl_contents.addr2_text		                                                                    	#@G01022
	LET frm_contents.bank_code = tbl_contents.bank_code		                                                                      	#@G01023
	LET frm_contents.city_text = tbl_contents.city_text		                                                                      	#@G01024
	LET frm_contents.days_to_del = tbl_contents.days_to_del		                                                                  	#@G01025
	LET frm_contents.state_code = tbl_contents.state_code		                                                                    	#@G01026
	LET frm_contents.post_code = tbl_contents.post_code		                                                                      	#@G01027
	LET frm_contents.country_code = tbl_contents.country_code		                                                                	#@G01028
	LET frm_contents.contact_text = tbl_contents.contact_text		                                                                	#@G01029
	LET frm_contents.tele_text = tbl_contents.tele_text		                                                                      	#@G01030
	LET frm_contents.fax_text = tbl_contents.fax_text		                                                                        	#@G01031
	LET frm_contents.price_high_per = tbl_contents.price_high_per		                                                            	#@G01032
	LET frm_contents.excess_day_num = tbl_contents.excess_day_num		                                                            	#@G01033
	LET frm_contents.approval_flag = tbl_contents.approval_flag		                                                              	#@G01034
	LET frm_contents.price_low_per = tbl_contents.price_low_per		                                                              	#@G01035
	LET frm_contents.excess_limit_per = tbl_contents.excess_limit_per		                                                        	#@G01036
	LET frm_contents.summ_cfwd_flag = tbl_contents.summ_cfwd_flag		                                                            	#@G01037
	LET frm_contents.cart_high_per = tbl_contents.cart_high_per		                                                              	#@G01038
	LET frm_contents.price_round_ind = tbl_contents.price_round_ind		                                                          	#@G01039
	LET frm_contents.edit_km_flag = tbl_contents.edit_km_flag		                                                                	#@G01040
	LET frm_contents.cart_low_per = tbl_contents.cart_low_per		                                                                	#@G01041
	LET frm_contents.disp_locn_ind = tbl_contents.disp_locn_ind		                                                              	#@G01042
	LET frm_contents.min_cartage_ind = tbl_contents.min_cartage_ind		                                                          	#@G01043
	LET frm_contents.price_auth_ind = tbl_contents.price_auth_ind		                                                            	#@G01044
	LET frm_contents.stocktake_ind = tbl_contents.stocktake_ind		                                                              	#@G01045
	LET frm_contents.head_info_flag = tbl_contents.head_info_flag		                                                            	#@G01046
	LET frm_contents.pallet_charge_ind = tbl_contents.pallet_charge_ind		                                                      	#@G01047
	LET frm_contents.def_labour_class = tbl_contents.def_labour_class		                                                        	#@G01048
	LET frm_contents.def_int_cust = tbl_contents.def_int_cust		                                                                	#@G01049
	LET frm_contents.ol_hold_code = tbl_contents.ol_hold_code		                                                                	#@G01050
	LET frm_contents.desc2_text = tbl_contents.desc2_text		                                                                    	#@G01051
	LET frm_contents.tt_hold_code = tbl_contents.tt_hold_code		                                                                	#@G01052
	LET frm_contents.comp_date = tbl_contents.comp_date		                                                                      	#@G01053
			                                                                                                                         	#@G01054
	RETURN frm_contents.*		                                                                                                   	#@G01055
END FUNCTION ## set_form_recordWZ5_W120		                                                                                 	#@G01056

################################################################################################		                         	#@G01058
FUNCTION set_table_record_W120_location(sql_stmt,frm_contents)		                                                           	#@G01059
## set_table_record_W120_location: assigns form fields value to table values		                                             	#@G01060
	DEFINE sql_stmt SMALLINT # 1 => Insert, 2 => Update		                                                                     	#@G01061
	DEFINE pky RECORD 		                                                                                                      	#@G01062
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G01062
		locn_code LIKE location.locn_code # nchar(3)				                                                                                                                         	#@G01063
	END RECORD		                                                                                                              	#@G01064
	
	DEFINE frm_contents RECORD		                                                                                              	#@G01066
		cmpy_code LIKE location.cmpy_code, #  nchar(2)		                                                                           	#@G01066
		locn_code LIKE location.locn_code, #  nchar(3)		                                                                           	#@G01066
		desc_text LIKE location.desc_text, #  nvarchar(40)		                                                                       	#@G01066
		addr1_text LIKE location.addr1_text, #  nvarchar(40)		                                                                     	#@G01066
		ware_code LIKE location.ware_code, #  nchar(3)		                                                                           	#@G01066
		addr2_text LIKE location.addr2_text, #  nvarchar(40)		                                                                     	#@G01066
		bank_code LIKE location.bank_code, #  nvarchar(9)		                                                                        	#@G01066
		city_text LIKE location.city_text, #  nvarchar(40)		                                                                       	#@G01066
		days_to_del LIKE location.days_to_del, #  smallint		                                                                       	#@G01066
		state_code LIKE location.state_code, #  nvarchar(6)		                                                                      	#@G01066
		post_code LIKE location.post_code, #  nvarchar(10)		                                                                       	#@G01066
		country_code LIKE location.country_code, #  nchar(3)		                                                                     	#@G01066
		contact_text LIKE location.contact_text, #  nvarchar(40)		                                                                 	#@G01066
		tele_text LIKE location.tele_text, #  nvarchar(20)		                                                                       	#@G01066
		fax_text LIKE location.fax_text, #  nvarchar(20)		                                                                         	#@G01066
		price_high_per LIKE location.price_high_per, #  DECIMAL		                                                                  	#@G01066
		excess_day_num LIKE location.excess_day_num, #  smallint		                                                                 	#@G01066
		approval_flag LIKE location.approval_flag, #  nchar(1)		                                                                   	#@G01066
		price_low_per LIKE location.price_low_per, #  DECIMAL		                                                                    	#@G01066
		excess_limit_per LIKE location.excess_limit_per, #  smallint		                                                             	#@G01066
		summ_cfwd_flag LIKE location.summ_cfwd_flag, #  nchar(1)		                                                                 	#@G01066
		cart_high_per LIKE location.cart_high_per, #  DECIMAL		                                                                    	#@G01066
		price_round_ind LIKE location.price_round_ind, #  nchar(1)		                                                               	#@G01066
		edit_km_flag LIKE location.edit_km_flag, #  nchar(1)		                                                                     	#@G01066
		cart_low_per LIKE location.cart_low_per, #  DECIMAL		                                                                      	#@G01066
		disp_locn_ind LIKE location.disp_locn_ind, #  nchar(1)		                                                                   	#@G01066
		min_cartage_ind LIKE location.min_cartage_ind, #  nchar(1)		                                                               	#@G01066
		price_auth_ind LIKE location.price_auth_ind, #  nchar(1)		                                                                 	#@G01066
		stocktake_ind LIKE location.stocktake_ind, #  nchar(1)		                                                                   	#@G01066
		head_info_flag LIKE location.head_info_flag, #  nchar(1)		                                                                 	#@G01066
		pallet_charge_ind LIKE location.pallet_charge_ind, #  nchar(1)		                                                           	#@G01066
		def_labour_class LIKE location.def_labour_class, #  nvarchar(8)		                                                          	#@G01066
		def_int_cust LIKE location.def_int_cust, #  nvarchar(8)		                                                                  	#@G01066
		ol_hold_code LIKE location.ol_hold_code, #  nchar(3)		                                                                     	#@G01066
		desc2_text LIKE location.desc2_text, #  nvarchar(60)		                                                                     	#@G01066
		tt_hold_code LIKE location.tt_hold_code, #  nchar(3)		                                                                     	#@G01066
		comp_date LIKE location.comp_date #  date		                                                                                	#@G01066
				                                                                                                                         	#@G01067
	END RECORD		                                                                                                              	#@G01068

	DEFINE tbl_contents RECORD		                                                                                              	#@G01070
		cmpy_code LIKE location.cmpy_code, # nchar(2)		                                                                            	#@G01070
		locn_code LIKE location.locn_code, # nchar(3)		                                                                            	#@G01070
		desc_text LIKE location.desc_text, # nvarchar(40)		                                                                        	#@G01070
		addr1_text LIKE location.addr1_text, # nvarchar(40)		                                                                      	#@G01070
		addr2_text LIKE location.addr2_text, # nvarchar(40)		                                                                      	#@G01070
		city_text LIKE location.city_text, # nvarchar(40)		                                                                        	#@G01070
		state_code LIKE location.state_code, # nvarchar(6)		                                                                       	#@G01070
		post_code LIKE location.post_code, # nvarchar(10)		                                                                        	#@G01070
		country_code LIKE location.country_code, # nchar(3)		                                                                      	#@G01070
		contact_text LIKE location.contact_text, # nvarchar(40)		                                                                  	#@G01070
		tele_text LIKE location.tele_text, # nvarchar(20)		                                                                        	#@G01070
		fax_text LIKE location.fax_text, # nvarchar(20)		                                                                          	#@G01070
		ware_code LIKE location.ware_code, # nchar(3)		                                                                            	#@G01070
		price_high_per LIKE location.price_high_per, # DECIMAL		                                                                   	#@G01070
		price_low_per LIKE location.price_low_per, # DECIMAL		                                                                     	#@G01070
		cart_high_per LIKE location.cart_high_per, # DECIMAL		                                                                     	#@G01070
		cart_low_per LIKE location.cart_low_per, # DECIMAL		                                                                       	#@G01070
		other_high_per LIKE location.other_high_per, # DECIMAL		                                                                   	#@G01070
		other_low_per LIKE location.other_low_per, # DECIMAL		                                                                     	#@G01070
		price_auth_ind LIKE location.price_auth_ind, # nchar(1)		                                                                  	#@G01070
		pallet_charge_ind LIKE location.pallet_charge_ind, # nchar(1)		                                                            	#@G01070
		bank_code LIKE location.bank_code, # nvarchar(9)		                                                                         	#@G01070
		days_to_del LIKE location.days_to_del, # smallint		                                                                        	#@G01070
		ol_hold_code LIKE location.ol_hold_code, # nchar(3)		                                                                      	#@G01070
		tt_hold_code LIKE location.tt_hold_code, # nchar(3)		                                                                      	#@G01070
		oltt_hold_code LIKE location.oltt_hold_code, # nchar(3)		                                                                  	#@G01070
		excess_day_num LIKE location.excess_day_num, # smallint		                                                                  	#@G01070
		excess_limit_per LIKE location.excess_limit_per, # smallint		                                                              	#@G01070
		price_round_ind LIKE location.price_round_ind, # nchar(1)		                                                                	#@G01070
		disp_locn_ind LIKE location.disp_locn_ind, # nchar(1)		                                                                    	#@G01070
		stocktake_ind LIKE location.stocktake_ind, # nchar(1)		                                                                    	#@G01070
		def_labour_class LIKE location.def_labour_class, # nvarchar(8)		                                                           	#@G01070
		desc2_text LIKE location.desc2_text, # nvarchar(60)		                                                                      	#@G01070
		comp_date LIKE location.comp_date, # date		                                                                                	#@G01070
		approval_flag LIKE location.approval_flag, # nchar(1)		                                                                    	#@G01070
		summ_cfwd_flag LIKE location.summ_cfwd_flag, # nchar(1)		                                                                  	#@G01070
		edit_km_flag LIKE location.edit_km_flag, # nchar(1)		                                                                      	#@G01070
		min_cartage_ind LIKE location.min_cartage_ind, # nchar(1)		                                                                	#@G01070
		head_info_flag LIKE location.head_info_flag, # nchar(1)		                                                                  	#@G01070
		def_int_cust LIKE location.def_int_cust # nvarchar(8)				                                                                                                                         	#@G01071
	END RECORD		                                                                                                              	#@G01072

	INITIALIZE tbl_contents.* TO NULL		                                                                                       	#@G01074
	LET tbl_contents.cmpy_code = frm_contents.cmpy_code		                                                                      	#@G01075
	LET tbl_contents.locn_code = frm_contents.locn_code		                                                                      	#@G01076
	LET tbl_contents.desc_text = frm_contents.desc_text		                                                                      	#@G01077
	LET tbl_contents.addr1_text = frm_contents.addr1_text		                                                                    	#@G01078
	LET tbl_contents.addr2_text = frm_contents.addr2_text		                                                                    	#@G01079
	LET tbl_contents.city_text = frm_contents.city_text		                                                                      	#@G01080
	LET tbl_contents.state_code = frm_contents.state_code		                                                                    	#@G01081
	LET tbl_contents.post_code = frm_contents.post_code		                                                                      	#@G01082
	LET tbl_contents.country_code = frm_contents.country_code		                                                                	#@G01083
	LET tbl_contents.contact_text = frm_contents.contact_text		                                                                	#@G01084
	LET tbl_contents.tele_text = frm_contents.tele_text		                                                                      	#@G01085
	LET tbl_contents.fax_text = frm_contents.fax_text		                                                                        	#@G01086
	LET tbl_contents.ware_code = frm_contents.ware_code		                                                                      	#@G01087
	LET tbl_contents.price_high_per = frm_contents.price_high_per		                                                            	#@G01088
	LET tbl_contents.price_low_per = frm_contents.price_low_per		                                                              	#@G01089
	LET tbl_contents.cart_high_per = frm_contents.cart_high_per		                                                              	#@G01090
	LET tbl_contents.cart_low_per = frm_contents.cart_low_per		                                                                	#@G01091
	# LET tbl_contents.other_high_per = your value 		                                                                          	#@G01092
	# LET tbl_contents.other_low_per = your value 		                                                                           	#@G01093
	LET tbl_contents.price_auth_ind = frm_contents.price_auth_ind		                                                            	#@G01094
	LET tbl_contents.pallet_charge_ind = frm_contents.pallet_charge_ind		                                                      	#@G01095
	LET tbl_contents.bank_code = frm_contents.bank_code		                                                                      	#@G01096
	LET tbl_contents.days_to_del = frm_contents.days_to_del		                                                                  	#@G01097
	LET tbl_contents.ol_hold_code = frm_contents.ol_hold_code		                                                                	#@G01098
	LET tbl_contents.tt_hold_code = frm_contents.tt_hold_code		                                                                	#@G01099
	# LET tbl_contents.oltt_hold_code = your value 		                                                                          	#@G01100
	LET tbl_contents.excess_day_num = frm_contents.excess_day_num		                                                            	#@G01101
	LET tbl_contents.excess_limit_per = frm_contents.excess_limit_per		                                                        	#@G01102
	LET tbl_contents.price_round_ind = frm_contents.price_round_ind		                                                          	#@G01103
	LET tbl_contents.disp_locn_ind = frm_contents.disp_locn_ind		                                                              	#@G01104
	LET tbl_contents.stocktake_ind = frm_contents.stocktake_ind		                                                              	#@G01105
	LET tbl_contents.def_labour_class = frm_contents.def_labour_class		                                                        	#@G01106
	LET tbl_contents.desc2_text = frm_contents.desc2_text		                                                                    	#@G01107
	LET tbl_contents.comp_date = frm_contents.comp_date		                                                                      	#@G01108
	LET tbl_contents.approval_flag = frm_contents.approval_flag		                                                              	#@G01109
	LET tbl_contents.summ_cfwd_flag = frm_contents.summ_cfwd_flag		                                                            	#@G01110
	LET tbl_contents.edit_km_flag = frm_contents.edit_km_flag		                                                                	#@G01111
	LET tbl_contents.min_cartage_ind = frm_contents.min_cartage_ind		                                                          	#@G01112
	LET tbl_contents.head_info_flag = frm_contents.head_info_flag		                                                            	#@G01113
	LET tbl_contents.def_int_cust = frm_contents.def_int_cust		                                                                	#@G01114
			                                                                                                                         	#@G01115

	RETURN tbl_contents.*		                                                                                                   	#@G01117
END FUNCTION ## set_table_recordW120_location		                                                                            	#@G01118

FUNCTION lookup_location_bank(l_cmpy_code,l_bank_code)		                                                                   	#@G01120
	DEFINE l_cmpy_code LIKE bank.cmpy_code
	DEFINE l_bank_code LIKE bank.bank_code
	DEFINE l_name_acct_text LIKE bank.name_acct_text		                                                                                     	#@G01123
	WHENEVER ERROR CONTINUE		                                                                                                  	#@G01124
	SELECT name_acct_text		                                                                                                    	#@G01124
	INTO l_name_acct_text		                                                                                                    	#@G01125
	FROM bank		                                                                                                                	#@G01126
	WHERE 	cmpy_code = l_cmpy_code		                                                                                                  	#@G01127
	AND bank_code = l_bank_code		                                                                                              	#@G01128
	IF sqlca.sqlcode = 100 THEN		                                                                                              	#@G01129
		LET l_name_acct_text = NULL		                                                                                              	#@G01130
	END IF		                                                                                                                   	#@G01131
	WHENEVER ERROR CALL error_mngmt		                                                                                          	#@G01132
	RETURN sqlca.sqlcode,l_name_acct_text		                                                                                    	#@G01133
END FUNCTION		                                                                                                             	#@G01134

FUNCTION lookup_location_warehouse(l_cmpy_code,l_ware_code)		                                                              	#@G01136
	DEFINE l_cmpy_code LIKE warehouse.cmpy_code
	DEFINE l_ware_code LIKE warehouse.ware_code		                                                                                              	#@G01138
	DEFINE l_desc_text LIKE warehouse.desc_text	                                                                                          	#@G01139
	WHENEVER ERROR CONTINUE		                                                                                                  	#@G01140
	SELECT desc_text		                                                                                                         	#@G01140
	INTO l_desc_text		                                                                                                         	#@G01141
	FROM warehouse		                                                                                                           	#@G01142
	WHERE 	cmpy_code = l_cmpy_code		                                                                                                  	#@G01143
	AND ware_code = l_ware_code		                                                                                              	#@G01144
	IF sqlca.sqlcode = 100 THEN		                                                                                              	#@G01145
		LET l_desc_text = NULL		                                                                                                   	#@G01146
	END IF		                                                                                                                   	#@G01147
	WHENEVER ERROR CALL error_mngmt		                                                                                          	#@G01148
	RETURN sqlca.sqlcode,l_desc_text		                                                                                         	#@G01149
END FUNCTION		                                                                                                             	#@G01150

		                                                                                                                         	#@G01152

		                                                                                                                         	#@G01154

		                                                                                                                         	#@G01156

		                                                                                                                         	#@G01158
